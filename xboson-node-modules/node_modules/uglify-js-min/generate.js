//
// 生成 uglify-js 的压缩版
// 保证 uglify-js 已经安装到上层目录
//
var node = require("../uglify-js/tools/node.js");
var fs = require('fs');

var code = [];

code.push('"use strict";');
code.push("(function() { var MOZ_SourceMap = require('source-map');");

node.FILES.forEach(function(file) {
  console.log('Code File', file);
  code.push( fs.readFileSync(file, "utf8") );
});

// 暂时无用
//code.push("exports.describe_ast = " + describe_ast.toString());

code.push('})()');
console.log('Min...........');
var res = node.minify(code.join("\n\n"));

if (res.error) {
  console.error(res.error);
  return;
}

fs.writeFileSync('./index.js', res.code);
