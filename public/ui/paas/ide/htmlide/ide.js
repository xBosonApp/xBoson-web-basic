function NewIDE(w){var _,C=105,l=220+C,r=100+C,n=80,t="lib/js/ace/1.4.2/ace.js",s={app:{add:[{name:"应用ID",id:"appid",type:"input",write:!0,width:6},{name:"应用名称",type:"input",id:"appnm",write:!0,width:6},{name:"应用状态",type:"select2",id:"status",write:!0,width:6},{name:"应用说明",type:"textarea",id:"about",write:!0,width:12}],edit:[{name:"应用ID",id:"appid",type:"input",write:!1,width:6},{name:"应用名称",type:"input",write:!0,id:"appnm",width:6},{name:"应用状态",type:"select2",id:"status",write:!0,width:6},{name:"创建时间",type:"input",id:"createdt",write:!1,width:6},{name:"修改时间",type:"input",id:"updatedt",write:!1,width:6},{name:"应用说明",type:"textarea",id:"about",write:!0,width:12}]},mod:{add:[{name:"业务ID",id:"moduleid",type:"input",write:!0,width:6},{name:"业务名称",type:"input",id:"modulenm",write:!0,width:6},{name:"业务分类",id:"auflag",type:"select2",write:!0,width:6},{name:"业务状态",id:"status",type:"select2",write:!0,width:6},{name:"业务说明",type:"textarea",id:"about",write:!0,width:12}],edit:[{name:"业务ID",type:"input",id:"moduleid",write:!1,width:6},{name:"业务名称",type:"input",id:"modulenm",write:!0,width:6},{name:"业务分类",type:"select2",id:"auflag",write:!0,width:6},{name:"业务状态",type:"select2",id:"status",write:!0,width:6},{name:"创建时间",type:"input",id:"createdt",write:!1,width:6},{name:"修改时间",type:"input",id:"updatedt",write:!1,width:6},{name:"业务说明",type:"textarea",id:"about",write:!0,width:12}]},api:{add:[{name:"API ID",id:"apiid",type:"input",write:!0,width:6},{name:"API 名称",id:"apinm",type:"input",write:!0,width:6},{name:"API 状态",type:"select2",id:"status",write:!0,width:6}],edit:[{name:"API ID",type:"input",id:"apiid",write:!1,width:6},{name:"API 名称",type:"input",id:"apinm",write:!0,width:6},{name:"API 状态",id:"status",type:"select2",write:!0,width:6},{name:"创建时间",id:"createdt",type:"input",write:!1,width:6},{name:"修改时间",id:"updatedt",type:"input",write:!1,width:6}]}};function a(){var a,e=$("#api_ide_content"),t=$(window).resize(d).scroll(function(){i=t.scrollTop(),e.css("margin-top",i)}),i=0;function n(){setTimeout(d,10)}function d(){var e=0<$("#jarviswidget-fullscreen-mode").length;_=t.height(),a=e?_-r:_-l,$("#maintree").css("height",a),$(".fix_size").css("height",a+C)}return e.find(".jarviswidget-fullscreen-btn").click(n),$.ready(d),d(),n}var c=a(),z={_api:function(e,a,t){if(e.apiid){var i=$.extend(!0,{},e.r_param);zy.g.am.mod=e.modid||"zymodule_ide",zy.g.am.app=e.appid||"zyapp_ide";var n=e.apitype||"ide/";zy.net.post(n+e.apiid,function(e){e?a&&a(e):t&&t(e)},i)}},_label:function(e){return $("<"+e+"></"+e+">")},_arrToObj:function(e,a){if(a){var t={};$.each(e,function(e,a){t[a]=!0})}else{t=[];$.each(e,function(e,a){t.push(a)})}return t}},e="\n[递交到 "+location.origin+"]",x=z._label("textarea").attr("placeholder","修改原因").val(e);var I={};function u(e){e?window.onbeforeunload=function(){return parent.$("body").removeClass("animated fadeOutUp"),"请确认代码已提交"}:(window.onbeforeunload=null,$(window).unbind("resize"),a())}function i(e){var a=$("#widget-grid").find("header .glyphicon-saved");var t=e.attr("id"),i=ace.edit(t);return $("#left-panel nav").bind("click",function(){i.destroy(),i.container.remove()}),i.setTheme("ace/theme/ambiance"),i.getSession().setMode("ace/mode/sjs"),i.$blockScrolling=1/0,zy.setEditorExOptions(i,"api"),i.commands.addCommand({name:"myCommand",bindKey:{win:"Ctrl+S",mac:"Command+S"},exec:function(e){a&&a.trigger("click")}}),{initSize:function(){i.setShowPrintMargin(!1),i.setFontSize(13.5),i.setHighlightSelectedWord(!0),i.setOption("wrap",n),i.setOption("tabSize",2),i.resize()},get:function(){return i.getValue().trim()},set:function(e,a,t){""==i.getValue().trim()?(setTimeout(function(){i.getSession().getUndoManager().reset()},1),i.setValue(e+"\n\n\n\n\n"),i.navigateFileStart(),i.setReadOnly(a)):zy.ui.msg(t||"","文件已经在IDE中打开","i")}}}function k(e,a){e.wid;var t=e.tree.ztree,d=e.mod;function r(e,a){return e.appid?e.moduleid?e.apiid&&e.contentid?"api":e.moduleid&&!e.apiid?a?"mod":"api":e.apiid&&e.hisid?"his":void 0:a?"app":"mod":"app"}var l=null;function p(l,o,e){var i=l;if(e){var a={appid:o.appid,moduleid:o.moduleid,apiid:o.apiid};zy.g.am.app="ZYAPP_IDE",zy.g.am.mod="ZYMODULE_IDE",zy.net.get("api/getapiinfo",function(e){$.each(e.result[0],function(e,a){var t=i.find("[name="+e+"]");0<t.length&&(t.hasClass("select2-offscreen")?t.select2("val",a):t.val(a.replace(/\.0/g,"")))})},a,null,function(e){})}var t=i.find("[name=ide_submit]");t.unbind(),t.click(function(){if(i=!0,l.children().find("input").each(function(e,a){var t=$(a).attr("name");t&&"updatedt"!==t&&"createdt"!==t&&""===t?(zy.ui.msg("提示",$(a).attr("placeholder")+"不可为空","w"),i=!1):t&&"apiid"===t&&($(a).val().match(/^[a-zA-Z_][a-zA-Z0-9_]*$/)||(zy.ui.msg("提示",'apiid请以字母或下划线"_"开始！',"w"),i=!1))}),i){var i,e,t,a,p="修改"===$(this).closest(".modal-content").find("h4").text()?1:0,n={},d={type:p};o.appid&&(d.appid=o.appid),o.moduleid&&(d.moduleid=o.moduleid),n.apiid=r(o,Boolean(p)),n.r_param=$.extend(!0,{},d,(t={},a=(e=l).find("textarea"),e.find("input").each(function(e,a){$(a).attr("role")||(t[$(a).attr("name")]=$(a).val())}),delete t.createdt,delete t.updatedt,t[a.attr("name")]=a.val(),t)),n.r_param.roleid=w,z._api(n,function(e){var a,t,i,n,d,l,r;a=o,t=Boolean(p),i=e.result[0],n=$.fn.zTree.getZTreeObj("maintree"),d=$.fn.zTree.getZTreeObj("resulttree"),l=n&&n.getNodeByParam("someid",a.someid,null),r=d&&d.getNodeByParam("someid",a.someid,null),t?(l&&($.extend(!0,l,i),n.updateNode(l)),r&&($.extend(!0,r,i),d.updateNode(r))):l&&n.addNodes(l,i),zy.ui.msg("提示信息","成功","s"),$(".modal").modal("hide")})}})}function n(e,i,a){var n=!0;void 0!==a&&(n=a),z._api({apiid:"apis",r_param:{roleid:w,id:e}},function(e){var a,t=e;t.value&&(n&&(a=t.value,$.each(a,function(e,a){a.isParent=!0})),i&&i(t.value),c())})}function o(e,a){var t={apiid:zy.fix_api_name("scode")};t.r_param=e,z._api(t,function(e){a&&a(e.content[0])})}var i={view:{showTitle:!0,selectedMulti:!1,showIcon:!0,dblClickExpand:!1},data:{key:{name:"appnm",title:"showid"},simpleData:{enable:!1}},edit:{drag:{isCopy:!1,isMove:!1},showRenameBtn:!1,showRemoveBtn:!1,enable:!0}};i.callback={onExpand:function(e,a,t){var i=!t.contentid;t.children||n(t.someid,function(e){var a=e;t.contentid&&$.each(a,function(e,a){a.appnm=a.appnm.replace(/(.0)$/g,"")}),t.children=a,l.refresh()},i)},onClick:function(e,a,i){if(i){var n=$("#widget-grid").find("header .glyphicon-cloud-upload").closest(".widget-toolbar"),d=$("#widget-grid").find("header .glyphicon-saved").parent(),l=$("#widget-grid").find("header .glyphicon-calendar").parent(),r=$("#widget-grid").find("header .glyphicon-play");i.hisid&&o({hisid:i.hisid},function(e){var a=i.hisid+i.apiid+i.moduleid+i.appid,t=m.add(i.apiid+"-"+i.appnm.replace(/[\(（][^\)）]+[\)）]/g,""),i.hisid,e.stability,a);t.inputc.val(e.updatecmt),h(function(){D.set(e.content,!0),D.initSize(),d.hide(),l.hide(),r.parent().hide(),n.hide(),c()},t.pre)}),i.contentid&&o({contentid:i.contentid},function(e){try{var a=i.apiid+"--"+i.moduleid+"--"+i.appid,t=m.add(i.apiid,i.contentid,e.stability,a);t.inputc.val(e.updatecmt),t.pre.attr("help_info",e.help_info),h(function(){n.trigger("show",[e.stability]),D.initSize(),D.set(e.content,!1,i.apiid),d.show(),l.show(),r.parent().show(),r.trigger("_init",[i,e.help_info]),c()},t.pre)}catch(e){throw console.log("ide/htmlide/ide.js",e),zy.ui.msg("IDE 打开错误","ID 使用了中文可能出错, 检查 app/module/api 的 id 是否正确.","e"),e}})}},onDblClick:function(e,a,t,i){}},i.view.addHoverDom=function(e,i){var a=$("#"+i.tId+"_span");if(!(i.editNameFlag||0<$("#addBtn_"+i.tId).length||0<$("#editBtn_"+i.tId).length)){var t="<span class='button add' id='addBtn_"+i.tId+"' title='添加' onfocus='this.blur();'></span>",n="<span class='button edit' id='editBtn_"+i.tId+"' title='修改' onfocus='this.blur();'></span>";i.moduleid&&!i.apiid&&a.after(t),i.contentid&&a.after(n),$("#addBtn_"+i.tId).bind("click",function(){var t;return l.selectNode(i),t=i,zy.net.loadHTML("ide/htmlide/ide_edit.html",d,function(){var e=r(t,!1);$(".modal-title").html("新增"),$("#ide_edit .modal-body").empty(),d._form($("#ide_edit .modal-body"),s[e].add),$("#ide_edit").modal("show"),p(d.find("form"),t,!1);var a=$("<textarea>").attr("style","display:none").attr("name","help_info");d.find("fieldset").append(a)}),!1}),$("#editBtn_"+i.tId).bind("click",function(){var a;return l.selectNode(i),a=i,zy.net.loadHTML("ide/htmlide/ide_edit.html",d,function(){var e=r(a,!0);$(".modal-title").html("修改"),$("#ide_edit .modal-body").empty(),d._form($("#ide_edit .modal-body"),s[e].edit),$("#ide_edit").modal("show"),p(d.find("form"),a,!0),"api"==e&&api_help.button(d.find("fieldset"),$("#modal_container3"),$(d.find("textarea")[0]),a)}),!1})}},i.view.removeHoverDom=function(e,a){$("#addBtn_"+a.tId).unbind().remove(),$("#editBtn_"+a.tId).unbind().remove()},t.empty(),a?l=$.fn.zTree.init(t,i,a):n("",function(e){if(0!=e.length){var a=[];a[0]={appnm:"xBoson IDE",children:e,open:!0,showid:"xBoson IDE"},l=$.fn.zTree.init(t,i,a)}0==e.length&&t.after($('<div style="text-align: center; vertical-align: middle;">空</div>'))})}function h(e,a){zy.net.loadScript.call(this,t,function(){D=i(a),e&&e()})}var D,d,p=function(e){function a(){var e,a,t,i,n=l.find(".jarviswidget-editbox"),d=z._label("div").addClass("row");d.append((e=function(a){D&&D.contentid&&(a.btnDisable(!0),z._api({apiid:zy.fix_api_name("ucode"),r_param:{contentid:D.contentid,content:D.get(),updatecmt:""}},function(e){e&&(a.btnDisable(!1),zy.ui.msg("提示信息",e.msg||"API保存成功","s"))}))},a=z._label("a").addClass("btn btn-labeled btn-success pull-right").attr("href","javascript:void(0);").css("margin-right","17px"),t=z._label("span").addClass("btn-label"),i=z._label("i").addClass("glyphicon glyphicon-ok"),a.append(t.append(i)).append("提交"),a.click(function(){e&&e($(this))}),a)),n.append(d)}var d,l=$("#"+e),f=z._label("div");f._form=function(e,a){var t,i,n,d,l=$.extend(!0,{},a),r=(t=l,i=[],n=[],d=[],$.each(t,function(e,a){12===a.width?n.push(a):"createdt"===a.id||"updatedt"===a.id?d.push(a):i.push(a)}),{half:i,full:n,time:d});function p(e){if(12!==e.width)var a=z._label("section").addClass("col col-"+e.width);else a=z._label("section");var t=z._label("label").addClass("label").html(e.name);if("textarea"===e.type)var i=z._label("label").addClass("textarea has-warning"),n=z._label("textarea").attr("name",e.id).attr("placeholder",e.name);else i=z._label("label").addClass("input has-warning"),n=z._label("input").attr("name",e.id).attr("type",e.type).attr("placeholder",e.name);"select2"===n.attr("type")&&n.attr("type","input"),e.write||n.attr("readonly","readonly");var d=z._label("b").addClass("tooltip tooltip-bottom-right").html(e.name+"为必填项");return i.append(n).append(d),a.append(t).append(i),a}function o(e){var a=e/2;return Math.round(a)===a}var s=z._label("form").attr("onsubmit","return false;").addClass("smart-form"),c=$("<fieldset></fieldset>");s.append(c),$.each(r.half,function(e,a){var t=e/2;if(o(e)){var i=z._label("div").addClass("row");s.children().append(i)}else t-=.5;s.find("div").eq(t).append(p(a))});var h,u,m,f,b,g=null;$.each(r.time,function(e,a){o(e)&&(g=z._label("div").addClass("row")),g.append(p(a)),s.children().append(g);var t=$("<textarea>").attr("style","display:none").attr("name","help_info");c.append(t)}),$.each(r.full,function(e,a){s.children().append(p(a))}),h=s,u=z._label("footer"),m=z._label("button").addClass("btn btn-default").attr("data-dismiss","modal").html("取消"),f=z._label("button").addClass("btn btn-primary").attr("name","ide_submit").html("确定"),u.append(m).append(f),h.append(u),b=l,$.each(b,function(e,a){"status"===a.id&&zy.cache.initDicts("ZR.0001",function(){s.find("[name="+a.id+"]").zySelect("ZR.0001",!1,{allowClear:!1,width:"100%"}),s.find("[name="+a.id+"]").select2("val","1")}),"auflag"===a.id&&zy.cache.initDicts("ZR.0029",function(){s.find("[name="+a.id+"]").zySelect("ZR.0029",!1,{allowClear:!1,width:"100%"}),s.find("[name="+a.id+"]").select2("val","0")})}),e.append(s)},zy.net.loadHTML("ide/htmlide/ide_run.html",f,function(e){d=e});var t=z._label("div").addClass("row"),i=z._label("div").addClass("col-xs-12 col-sm-9").css({});i.unbind(),i.bind("size",function(e){$(this).removeClass();var a=$(this).siblings(":visible");if(0<a.length){var t=0;$.each(a,function(e,a){t+=Number($(a).attr("class").replace(/col-xs-12 col-sm-/g,""))}),$(this).addClass("col-xs-12 col-sm-"+(12-t))}else $(this).addClass("col-xs-12 col-sm-12")});var n,r,p,o,s,c,h,u,m,b,g,v=z._label("pre").attr("id","zy_ide_editor"),a=z._label("div").addClass("col-xs-12 col-sm-3").css({display:"none"}),y=function(){var e,a,t,i=z._label("div").addClass("col-xs-12 col-sm-3");e=i,a=z._label("div").addClass("input-group input-group-sm").attr("style","width:100%;margin-bottom:-15px"),(t=z._label("header")).append(z._label("label").html("API 列表")).append(z._label("a").attr("href","javascript:void(0);").addClass("pull-right").append(z._label("i").addClass("fa fa-times"))),e.append(a.append(t)),e.append(z._label("legend")),t.children("a").unbind(),t.children("a").click(function(){var e=$(this).closest(".col-sm-3");e.hide(),e.parent().children(":eq(1)").trigger("size")});var n=z._label("ul").addClass("ztree").attr("id","maintree");return i.append(z._label("div").attr("style","overflow: auto;").addClass("row").css("margin-top","-15px").append(n)),function(e){var a=z._label("form").attr("onsubmit","return false;").addClass("smart-form"),t=z._label("_section").append(z._label("label").addClass("label").html("递交时的注解 (修改原因)")),i=z._label("label").addClass("textarea has-warning").append(x).append(z._label("b").addClass("tooltip tooltip-bottom-right").html("修改原因为必填项"));t.append(i),a.append($("<fieldset></fieldset>").append(t)),e.append(a);var n=setInterval(function(){a.height()<=0||(clearInterval(n),C=a.height()||105)},100)}(i),{container:i,ul:n}}();return l.closest("#widget-grid").after(f),v.attr("style","font-family:Consolas,PingFang SC,Source Han Sans SC Light,Microsoft YaHei,Arial,Sans-Serif;top:-14;height:100%; width:100%;"),t.append(y.container).append(i).append(a),l.find(".widget-body").empty().append(t),(n=l.children("header")).append(function(){function e(){var e=$("#zy_tabs").closest(".row").children(":last");$("#jarviswidget-fullscreen-mode").length,function(e,a){var t,i;e.empty(),t=z._label("div").addClass("input-group input-group-sm").attr("style","width:100%;margin-bottom:-15px"),(i=z._label("header")).append(z._label("label").html("按内容查询")).append(z._label("a").attr("href","javascript:void(0);").addClass("pull-right").append(z._label("i").addClass("fa fa-times"))),e.append(t.append(i)),e.append(z._label("legend")),i.children("a").unbind(),i.children("a").click(function(){var e=$(this).closest(".col-sm-3");e.hide(),e.parent().children(":eq(1)").trigger("size")});var n=z._label("ul").addClass("ztree").attr("id","resulttree"),d=z._label("div").addClass("smart-form").attr("style","margin-top:-10px");e.append(d),e.append(z._label("legend"));var l,r,p,o,s=z._label("textarea ").attr("placeholder","内容").attr("rows","3"),c=(z._label("_label").addClass("glyphicon glyphicon-search").attr("rel","tooltip").attr("title","查询"),z._label("button").addClass("btn btn-default btn-xs pull-right").attr("style","margin-top:5px;margin-right:14px").html("查询")),h=z._label("i").addClass("fa fa-times pull-right").attr("style","margin-right:13px"),u=z._label("label").addClass("toggle state-error pull-left").attr("style","margin:4px 0 0 5px");u.append(z._label("input").attr("type","checkbox")).append(z._label("i").attr({"data-swchoff-text":"off","data-swchon-text":"on",title:"区分大小写"})),e.append(z._label("div").addClass("row").attr("style","margin-top:-10px;display:none").append(z._label("h").attr("style","margin-left:20px").html("查询结果")).append(h)),l="overflow:auto;display:none;height:",l+=_-400+"px",e.append(z._label("div").addClass("row").attr("style",l).append(n)),d.append(z._label("label").addClass("textarea").append(s)),d.append(z._label("div").addClass("row").attr("style","margin-bottom:-10px").append(u).append(c)),(o=h).unbind(),o.click(function(){var e=$(this).closest("div");e.hide(),e.next().hide(),e.prev().hide()}),r=c,p=u.children("input"),(r||p)&&(r.unbind(),r.click(function(){var e=p.prop("checked"),a={apiid:"querycontent"};a.r_param={roleid:w,content:s.val(),casesensitive:e},z._api(a,function(e){n.siblings().remove(),n.empty(),0===e.result.length?n.parent().append(z._label("div").css({"text-align":"center","vertical-align":"middle"}).html("空")):k({tree:{ztree:n},mod:f},e.result),n.parent().siblings(":hidden").show(),n.parent().show()})}))}(e),e.show(),$("#zy_tabs").parent().trigger("size")}function a(){var e=$("#zy_tabs").closest(".row").children(":last"),a=!1;0<$("#jarviswidget-fullscreen-mode").length&&(a=!0),function(e,a){function t(){var e=z._label("span").addClass("onoffswitch"),a=z._label("input").addClass("onoffswitch-checkbox").attr("type","checkbox").attr("name","start_interval").attr("id","start_interval"),t=z._label("label").addClass("onoffswitch-label").attr("for","start_interval");return t.append(z._label("span").addClass("onoffswitch-inner").attr("data-swchoff-text","Api").attr("data-swchon-text","Mod")).append(z._label("span").addClass("onoffswitch-switch")),e.append(a).append(t),{container:e,input:a}}var i,n;e.empty(),i=z._label("div").addClass("input-group input-group-sm").attr("style","width:100%;margin-bottom:-15px"),(n=z._label("header")).append(z._label("label").html("按name/id查询")).append(z._label("a").attr("href","javascript:void(0);").addClass("pull-right").append(z._label("i").addClass("fa fa-times"))),e.append(i.append(n)),e.append(z._label("legend")),n.children("a").unbind(),n.children("a").click(function(){var e=$(this).closest(".col-sm-3");e.hide(),e.parent().children(":eq(1)").trigger("size")});var d=z._label("ul").addClass("ztree").attr("id","resulttree"),l=z._label("div").addClass("input-group input-group-sm").attr("style","margin:-10px 0-5px"),t=t();e.append(l),e.append(z._label("legend")),l.append(z._label("span").addClass("input-group-addon").append(t.container));var r=z._label("input").addClass("form-control").attr("placeholder","查询").attr("type","text"),p=z._label("_label").addClass("glyphicon glyphicon-search").attr("rel","tooltip").attr("title","查询"),o=z._label("button").addClass("btn btn-default").html("查询"),s=z._label("a").attr("href","javascript:void(0);").addClass("pull-right").append(z._label("i").addClass("fa fa-times")).attr("style","margin-right:13px");e.append(z._label("div").addClass("row").attr("style","margin-top:-10px;display:none").append(z._label("h").attr("style","margin-left:20px").html("查询结果")).append(s));var c,h,u,m="overflow:auto;display:none;height:";a&&(m="overflow:auto;display:none;height:"),m+=_-300+"px",e.append(z._label("div").addClass("row").attr("style",m).append(d)),l.append(z._label("div").addClass("icon-addon addon-sm").append(r).append(p)),l.append(z._label("span").addClass("input-group-btn").append(o)),(u=s).unbind(),u.click(function(){var e=$(this).closest("div");e.hide(),e.next().hide(),e.prev().hide()}),c=o,h=t.input,(c||h)&&(c.unbind(),c.click(function(){var e=h.prop("checked"),a={apiid:"queryidorname"};a.r_param={roleid:w,type:e?"mod":"api",content:r.val()},z._api(a,function(e){d.siblings().remove(),d.empty(),0===e.result.length?d.parent().append(z._label("div").css({"text-align":"center","vertical-align":"middle"}).html("空")):k({tree:{ztree:d},mod:f},e.result),d.parent().siblings(":hidden").show(),d.parent().show()})}))}(e,a),e.show(),$("#zy_tabs").parent().trigger("size")}var t,i,n=z._label("div").attr("role","menu").addClass("widget-toolbar").attr("title","功能表"),d=z._label("i").addClass("fa fa-align-justify dropdown-toggle").attr("data-toggle","dropdown"),l=z._label("ul").addClass("dropdown-menu pull-right");return n.append(z._label("div").addClass("btn-group").append(d).append(l)),t=[{id:"byid",name:"按 ID/名称 查找"},{id:"bycontent",name:"按 API 内容查找"}],i=l,$.each(t,function(e,a){var t=z._label("li").append(z._label("a").html(a.name)).attr("id",a.id);i.append(t)}),l.children().unbind(),l.children().click(function(){"byid"===$(this).attr("id")&&a(),"bycontent"===$(this).attr("id")&&e()}),n}()),n.append((r=z._label("div").attr("role","menu").addClass("widget-toolbar").attr("style","display:none;").attr("title","保存"),(p=z._label("i").addClass("glyphicon glyphicon-saved")).unbind(),p.click(function(){f.empty(),function(){var e=x.val().trim();if(""===e)return zy.ui.msg("提示","修改原因为必填项","w");var a=$("#zy_tabs").children("div:visible").find("pre").attr("id"),t=$("#zy_tabs").children("div:visible").find("div").attr("id"),i=ace.edit(a);zy.setEditorExOptions(i),$("#left-panel nav").bind("click",function(){i.destroy(),i.container.remove()});var n=$("#widget-grid").find("header .glyphicon-cloud-upload").closest(".widget-toolbar");i&&t&&($(this).btnDisable(!0),z._api({apiid:zy.fix_api_name("ucode"),r_param:{contentid:t,content:i.getValue().trim(),updatecmt:e}},function(e){e&&($(this).btnDisable(!1),zy.ui.msg("提示信息",e.msg||"API保存成功","s"),$(".modal").modal("hide"),n.trigger("show","00"))}))}()}),r.append(p))),n.append((o=z._label("div").attr("role","menu").addClass("widget-toolbar").attr("style","display:none;").attr("title","测试"),(s=z._label("i").addClass("glyphicon glyphicon-play")).unbind(),s.bind("_init",function(e,i,n){s.unbind("click"),i&&s.click(function(){var e,a,t={appid:i.appid,moduleid:i.moduleid,apiid:i.apiid};zy.g.am.app="ZYAPP_IDE",zy.g.am.mod="ZYMODULE_IDE",zy.net.get("api/getapiinfo",function(e){n=e.result[0].help_info},t,null,function(e){}),e=i,a=n,f.html(d),RunApi(e,a)})}),o.append(s))),n.append((c=z._label("div").attr("role","menu").addClass("widget-toolbar").attr("style","display:none;").attr("title","历史"),(h=z._label("i").addClass("glyphicon glyphicon-calendar")).unbind(),h.click(function(){var e=$("#zy_tabs").children("div:visible").find("pre").attr("id");zy.net.loadHTML("ide/htmlide/ide_his.html",f,function(){his(e)})}),c.append(h))),n.append(function(){var e=z._label("div").attr("role","menu").addClass("widget-toolbar").attr("style","display:none;").attr("title","更改状态");e.append(z._label("div").addClass("btn-group"));var l,a=z._label("i").addClass("glyphicon glyphicon-cloud-upload dropdown-toggle").attr("data-toggle","dropdown"),t=z._label("ul").addClass("dropdown-menu pull-right");return e.unbind("show"),e.bind("show",function(e,d){l||(l=!0,function(a,t){var e=I[a];if(e)return t(e);z._api({apitype:"api/",apiid:"getdict",appid:"ZYAPP_LOGIN",modid:"ZYMODULE_LOGIN",r_param:{typecd:a,orgid:"a297dfacd7a84eab9656675f61750078"}},function(e){I[a]=e,t(e)})}("ZR.0031",function(e){try{var a=$("#widget-grid").find("header .glyphicon-cloud-upload").closest(".widget-toolbar");(function(e,a){if(e.empty(),"50"!==a)return"60"!==a||(t=z._label("li").append(z._label("a").html("API已下线")).css({"text-align":"center","vertical-align":"middle"}),e.append(t),!1);var t=z._label("li").append(z._label("a").html("API已发布")).css({"text-align":"center","vertical-align":"middle"});return e.append(t),!1})(a.find("ul"),d)&&(t=e.result[0]["ZR.0031"],i=a.find("ul"),n=d,i.empty(),$.each(t,function(e,a){var t=z._label("li").append(z._label("a").attr("href","javascript:void(0);").html(a.name).attr("status",a.id));a.id==n&&(t.children().addClass("editable-disabled"),e=z._label("i").addClass("fa fa-gear fa-1x fa-spin"),t.children().append(e)),i.append(t),t.click(function(){var a=this;if(!(0<$(this).find("i").length)){var t=$(this).parent().find("i"),i=$("#zy_tabs").children("div:visible").find("div"),n=$(this).children().attr("status");z._api({apiid:"updatestability",r_param:{contentid:i.attr("id"),stability:n}},function(e){i.attr("stability",n),zy.ui.msg("提示","修改成功","s"),0<t.length?$(a).children().append(t):$(a).children().append(z._label("i").addClass("fa fa-gear fa-1x fa-spin"))})}})})),a.show()}catch(e){console.error("ide/htmlide/ide.js",e)}finally{l=!1}var t,i,n}))}),e.children().append(a).append(t).parent()}()),n.append((u=z._label("div").attr("role","menu").addClass("widget-toolbar").attr("title","API 列表"),(m=z._label("i").addClass("glyphicon glyphicon-folder-open")).unbind(),m.click(function(){y.container.is(":visible")?($(this).children().removeClass().addClass("glyphicon glyphicon-chevron-right"),y.container.hide()):($(this).children().removeClass().addClass("glyphicon glyphicon-chevron-left"),y.container.show()),$("#zy_tabs").parent().trigger("size")}),u.append(m))),n.append((b=z._label("div").attr("role","menu").addClass("widget-toolbar").attr("title","API返回通用数据结构"),(g=z._label("i").addClass("glyphicon glyphicon-list-alt")).unbind(),g.click(function(){zy.net.loadHTML("ide/htmlide/ide_message.html",f,function(){})}),b.append(g))),{wid:l,tree:{ztree:y.ul,container:y.container,sResultCon:y.sResult},pre:i,mod:f,result:a}}("ide"),m=function(h){function s(e){e.click(function(){var e=$("#widget-grid").find("header .glyphicon-cloud-upload").closest(".widget-toolbar"),a=h.wid.children("header").find(".glyphicon-saved").parent(),t=h.wid.children("header").find(".glyphicon-calendar").parent(),i=h.wid.children("header").find(".glyphicon-play");1==c.getCount()&&(u(!1),e.hide(),t.hide(),i.parent().hide(),a.hide())})}function e(){c.el.on("tabsbeforeactivate",function(e,a){var t=a.newPanel.children().children(),i=$("#widget-grid").find("header .glyphicon-cloud-upload").closest(".widget-toolbar"),n=h.wid.children("header").find(".glyphicon-saved").parent(),d=h.wid.children("header").find(".glyphicon-calendar").parent(),l=h.wid.children("header").find(".glyphicon-play");if(t.attr("id")){i.trigger("show",[t.attr("stability")]),l.parent().show();var r=a.newPanel.find("pre").attr("id")||"",p=a.newPanel.find("pre").attr("help_info")||"";if(""!=r){var o=r.split("--")[2],s=r.split("--")[1],c=r.split("--")[0];l.trigger("_init",[{appid:o,moduleid:s,apiid:c},p])}n.show(),d.show(),i.show()}else l.parent().hide(),n.hide(),d.hide(),i.hide()})}var a=h.pre,c=new zyTabs(a);return e(),{add:function(e,a,t,i){u(!0);var n=z._label("pre");n.attr("style","font-family:Consolas,PingFang SC,Source Han Sans SC Light,Microsoft YaHei,Arial,Sans-Serif;top:-14;height:100%; width:100%;").attr("id",i);var d=_-200,l=z._label("input").addClass("form-control").attr("readonly","readonly"),r=z._label("div").addClass("row").css("height",d).append(n).addClass("fix_size"),p=z._label("div").attr("style",_).append(r);a&&p.attr("id",a),t&&p.attr("stability",t);var o=c.AddTab(i,e,!0,p);return o?(c.active(o),{pre:c.el.find("[aria-hidden=false]").find("pre"),inputc:l}):(s(c.el.find("li[aria-selected=true]").find(".hover-transparent:has(i)")),{pre:n,inputc:l})},eventOn:e,delbtn:s}}(p);!function(){var e=navigator.userAgent.toLowerCase(),a="ipad"==e.match(/ipad/i),t="iphone os"==e.match(/iphone os/i),i="midp"==e.match(/midp/i),n="rv:1.2.3.4"==e.match(/rv:1.2.3.4/i),d="ucweb"==e.match(/ucweb/i),l="android"==e.match(/android/i),r="windows ce"==e.match(/windows ce/i),p="windows mobile"==e.match(/windows mobile/i);if(a||t||i||n||d||l||r||p){var o=window.screen.height;$("article").attr("style","overflow: auto;height:"+o+"px;"),$(window).resize(function(){$("article").attr("style","overflow: auto;height:"+o+"px;")})}}(),k(p),pageSetUp(),d=p,$("#left-panel a[href]").one("click",function(){window.onbeforeunload=null,$(window).unbind("resize"),a()}),d.tree.container,$("#zy_tabs").parent(),d.wid.find(".jarviswidget-fullscreen-btn").click(function(){var e=d.result.find("div:has(ul)");if(window.ee=e,$("#zy_tabs").find("div.row:has(pre)"),$("#zy_tabs").find("p").children(),0!=$("pre").length)var a=$("#zy_tabs").children("div:visible").find("pre"),t=$("#zy_tabs").children("div:visible").find("pre").attr("id");$("#jarviswidget-fullscreen-mode").length,0!=$("pre").length&&(D=ace.edit(t),$("#left-panel nav").bind("click",function(){D.destroy(),D.container.remove()}),D.setOption("wrap",n),D.setOption("tabSize",2),i(a),zy.setEditorExOptions(D))})}