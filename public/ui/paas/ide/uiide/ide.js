!function(v,_){var l,f={"":1,html:1,htm:1,md:1},n="lib/js/ace/1.4.2/ace.js",d={edit:[{name:"名称",id:"filenm",type:"input",write:!0,width:6},{name:"类型",id:"type",type:"input",write:!0,width:6}]};function y(e){_.setEditorExOptions(e)}l=_.isXBosonSystem?function(e){return _.g.host.api+"app/"+_.g.comm.org+"/ZYAPP_IDE/ZYMODULE_UI_IDE/"+e}:function(e){return"http://"+location.host+"/api/"+_apinm};var w,u=220;function t(){var e,t=v("#ide"),a=v(window).resize(i).scroll(function(){n=a.scrollTop(),t.css("margin-top",n)}),n=0;function i(){w=a.height(),e=w-u,v("#maintree").css("height",e),v(".fix_size").css("height",e)}v.ready(i),i(),i}t();var C={_api:function(e,t,a,n){a||(a={});var i=a.cb="callback"+_.tool.random();v.ajax({url:l(e),dataType:"jsonp",data:_.fix_jsonp_parm(a),type:n||"GET",jsonpCallback:i,success:function(e){_.fix_xboson_data(e),e.ret=e.code,t(e)},error:function(e,t,a){_.log("Error: "+a.message)}})},_apis:function(e,t,a,n){v.ajax({url:l(e),data:a||{},type:n||"GET",success:function(e){_.fix_xboson_data(e),t(e)},error:function(e,t,a){_.log("Error: "+a.message)}})},_formPost:function(e,t,a){var n=l(e)+"?onweb=1&"+_.net.parseParam(_.g.comm);t.ajaxSubmit({url:n,type:"post",async:!1,timeout:1e4,cache:!1,dataType:"json",success:function(e){_.fix_xboson_data(e),a&&a(e)}})},_post:function(e,t,a){v.post(l(e),a,function(e){_.fix_xboson_data(e),e.ret=e.code,t&&t(e)})},_label:function(e){return v("<"+e+"></"+e+">")},_image:function(e){return v("<"+e+"/>")},_arrToObj:function(e,t){if(t){var a={};v.each(e,function(e,t){a[t]=!0})}else{a=[];v.each(e,function(e,t){a.push(t)})}return a}};function m(e){window.onbeforeunload=e?function(){return parent.$("body").removeClass("animated fadeOutUp"),"请确认代码已提交"}:null,v(window).unbind("resize"),t()}function r(e,t){var a=v("#widget-grid").find("header .glyphicon-saved");var n=e.attr("id"),i=ace.edit(n);return v("#left-panel nav").bind("click",function(){i.container.remove()}),i.setTheme("ace/theme/ambiance"),t&&"htm"!=t?i.getSession().setMode("ace/mode/"+t):i.getSession().setMode("ace/mode/html"),i.$blockScrolling=1/0,y(i),i.commands.addCommand({name:"myCommand",bindKey:{win:"Ctrl+S",mac:"Command+S"},exec:function(e){a&&a.trigger("click")}}),{get:function(){return i.getValue().trim()},set:function(e,t,a){""==i.getValue().trim()?(setTimeout(function(){i.getSession().getUndoManager().reset()},1),i.setValue(e+"\n\n\n\n\n"),i.navigateFileStart(),i.setReadOnly(t)):_.ui.msg(a||"","文件已经在IDE中打开","i")},initSize:function(){i.setShowPrintMargin(!1),i.setFontSize(13.5),i.setHighlightSelectedWord(!0),i.setOption("wrap",120),i.setOption("tabSize",2)}}}function x(e,t){e.wid;var a=e.tree.ztree,r=e.mod;function h(e,t,a){var n=v.fn.zTree.getZTreeObj("maintree"),i=v.fn.zTree.getZTreeObj("resulttree"),l=n&&n.getNodeByParam("path",e.path,null),d=i&&i.getNodeByParam("path",e.path,null);if("e"===t&&(l&&(v.extend(!0,l,a),n.updateNode(l),n.refresh()),d&&(v.extend(!0,d,a),i.updateNode(d))),"a"===t&&(l&&n.addNodes(l,a),d&&i.addNodes(d,a)),"r"===t){if(l){var r=l.getParentNode();n.removeNode(l),r.isParent=!0,n.updateNode(r)}if(d){var s=d.getParentNode();i.removeNode(d),0===s.level&&0===s.children.length&&(i.destroy(),v("#resulttree").parent().append(C._label("div").css({"text-align":"center","vertical-align":"middle"}).html("空"))),s.isParent=!0,i.updateNode(s)}}}var u=null;function s(p,c,e){var n=p;e&&v.each(c,function(e,t){var a=n.find("[name="+e+"]");0<a.length&&(a.hasClass("select2-offscreen")?a.select2("val",t.replace(/(.0)$/g,"")):a.val(t.replace(/(.0)$/g,"")))});var t=n.find("[name=ide_submit]");t.unbind(),t.click(function(){var i,e=v(".modal-body").find("[type=input]").val(),t=v("input[name=type]:checked").val();if("文件夹"===t)i=e.toLowerCase(),t=null;else{var a=[e,t].join(".");i=a.toLowerCase()}var n=e.length;if(l=!0,p.children().find("input").each(function(e,t){if(v(t).attr("name")&&"updatedt"!==v(t).attr("name")&&"createdt"!==v(t).attr("name")&&""===v(t).val()&&"type"!=v(t).attr("name"))return _.ui.msg("提示",v(t).attr("placeholder")+"不可为空","w"),l=!1}),l){var l,d,r="修改文件名"===v(this).closest(".modal-content").find("h4").text(),s=v.extend(!0,{},{path:c.path},(d={},p.find("input").each(function(e,t){var a=v("input[name=type]:checked").val();"文件夹"===a?(v(t).attr("role")||(d[v(t).attr("name")]=v(t).val()),"type"===v(t).attr("name")&&(d.type=!1)):([v(t).val(),a].join("."),v(t).attr("role")||(d[v(t).attr("name")]=v(t).val()),"type"===v(t).attr("name")&&(d.type=!0))}),d),_.g.comm);if(s.ext_name=t,/(^[\u4e00-\u9fa5a-zA-Z0-9_\-\.]+$)/.test(e))if(r)if(60<n)_.ui.msg("提示信息","名称必须在60个字以内","w");else{var o=c.getParentNode();m(o.path,function(e){var t=e;v.isArray(t)?o.children=t:o.children=t.children;var n=!1;v.each(o.children,function(e,t){var a=t.name.toLowerCase();if(i==a)return!(n=!0)}),n?_.ui.msg("提示信息","存在","e"):C._api("rename",function(e){Boolean(e.ret)?_.ui.msg("提示信息","接口执行失败:"+e.msg,"e"):(h(c,"e",e.result),_.ui.msg("提示信息","修改成功"+e.msg,"s"),v(".modal").modal("hide"),e.result||m(o.path,function(e){var t=e;v.isArray(t)?o.children=t:o.children=t.children,o.open=!0,u.updateNode(o),u.refresh()},!1))},s)},!1)}else 60<n?_.ui.msg("提示信息","名称必须在60个字以内","w"):m(c.path,function(e){var t=e;v.isArray(t)?c.children=t:c.children=t.children;var n=!1;v.each(c.children,function(e,t){var a=t.name.toLowerCase();if(i==a)return!(n=!0)}),n?_.ui.msg("提示信息","存在","e"):C._api("mkfile",function(e){Boolean(e.ret)?_.ui.msg("提示信息","接口执行失败:"+e.msg,"e"):m(c.path,function(e){var t=e;v.isArray(t)?c.children=t:c.children=t.children,c.open=!0,u.updateNode(c),u.refresh(),_.ui.msg("提示信息","新增成功","s"),v(".modal").modal("hide")},!1)},s)},!1);else _.ui.msg("提示信息","不准输入除中文、字母、数字以外的特殊字符","w")}})}function o(n){var i=n.name,e=i.split(".").length,l=n.name.split(".")[e-1];/^(png)$|^(jpg)$|^(jpeg)$|^(gif)$|^(ico)$|^(htm)$|^(html)$|^(js)$|^(css)$|^(woff2)$|^(woff)$|^(ttf)$|^(svg)$|^(eot)$|^(zip)$|^(rar)$|^(psd)$|^(ai)$|^(mp4)$|^(m4v)$|^(pdf)$|^(txt)$|^(md)$|^(swf)$|^(doc)$|^(ppt)$|^(xls)$/.test(l)?_lastname=l:_lastname="文件夹",_.net.loadHTML("ide/uiide/ide_edit.html",r,function(){if(n.isParent)n.name;else{var e=l.length,t=i.length-(e+1);n.name.substr(0,t)}var a={filenm:n.name};v(".modal-title").html("修改文件名"),v(".modal-body").empty(),r._form(v(".modal-body"),d.edit,a),v(".modal").modal("show"),function(e){e.empty();var t,a,n=C._label("div").addClass("inline-group");n.append((t=_lastname,(a=C._label("label").addClass("radio")).html(t).append(C._label("input").attr({type:"radio",name:"type",checked:!0,value:_lastname})).append(C._label("i")),a)),e.append(n)}(v(".modal-body").find("[name=type]").parent()),s(r.find("form"),n,!0)})}function m(e,a,t){var n={};v.extend(!0,n,_.g.comm),n.path=e,C._api("getfilelist",function(e){if(console.log(e,!Boolean(e.ret)),Boolean(e.ret))_.ui.msg("提示","接口执行失败:"+e.msg,"e");else{var t=e.result;v.isArray(t)?t=i(t):t.children=i(t.children),a&&a(t)}},n)}function i(e){var a=[],n=[];return v.each(e,function(e,t){t.isParent?n.push(t):a.push(t)}),[].concat(n,a)}var n={view:{showTitle:!0,selectedMulti:!1,showIcon:!0,dblClickExpand:!1},data:{key:{name:"name",title:"path"},simpleData:{enable:!1},keep:{parent:!0}},edit:{drag:{isCopy:!1,isMove:!1},showRenameBtn:!1,showRemoveBtn:!1,enable:!0}};n.callback={onExpand:function(e,t,a){a.children&&0!==a.children.length||m(a.path,function(e){var t=e;a.children=t,u.refresh()},!1)},onClick:function(e,a,n){if(n.isParent&&v("#zy_tabs").closest(".row").children(":last").find("[type=text]").val(n.path),!n.isParent){var t={path:n.path,orgid:_.g.comm.org},i=e.target;if(!v(i).attr("title")){if(!n)return;var l,d=v("#widget-grid").find("header .glyphicon-saved").parent(),r=v("#widget-grid").find("header .glyphicon-play").parent(),s=n.name,o=s.split(".").length,p=s.split(".")[o-1];if(a=(s+n.path).replace(/\//g,"").replace(/\./g,""),/^(png)|(jpg)|(jpeg)|(gif)|(ico)/.test(p))l=_.isXBosonSystem?_.g.host.ui:"/web/zr",_path=l+n.path,j.add(s,n.path,a,p,_path).inputc.val("");else C._api("getcontent",function(e){if(Boolean(e.ret))_.ui.msg("提示","接口执行失败:"+e.msg,"e");else{var t=j.add(s,n.path,a);t.inputc.val(""),z(function(){k.set(e.result.content,!1,n.path),k.initSize(),d.show()},t.pre,e.result.filetype),f[e.result.filetype]?r.show():r.hide()}},v.extend(!0,t,_.g.comm))}}}},n.view.addHoverDom=function(e,a){var t=v("#"+a.tId+"_span");if(!(a.editNameFlag||0<v("#addBtn_"+a.tId).length||0<v("#editBtn_"+a.tId).length||0<v("#remBtn_"+a.tId).length)){var n="<span class='button add' id='addBtn_"+a.tId+"' title='添加' onfocus='this.blur();'></span>",i="<span class='button edit' id='editBtn_"+a.tId+"' title='修改' onfocus='this.blur();'></span>",l="<span class='button remove' id='remBtn_"+a.tId+"' title='删除' onfocus='this.blur();'></span>",d=a.tId;/maintree/.test(d)&&0!==a.level&&t.after(l).after(i),a.isParent&&t.after(n),0===a.level&&-1<a.tId.indexOf("resulttree")&&v("#addBtn_"+a.tId).unbind().remove(),v("#remBtn_"+a.tId).bind("click",function(){var e;e=a.isParent?"删除文件夹会删除其中包含的文件，确认要删除":"确认要删除",_.ui.mask("请确认",e+a.name+"?",function(){var t={};t.path=a.path,_.g.am.app="ZYAPP_IDE",_.g.am.mod="uiidemod",_.net.get("api/save_remove",function(e){"0"==e.ret&&C._api("remove",function(e){return Boolean(e.ret)?_.ui.msg("提示信息","接口执行失败,"+e.msg,"e"):(h(a,"r"),_.ui.msg("提示信息",e.msg,"s"))},v.extend(!0,t,_.g.comm))},null)})}),v("#addBtn_"+a.tId).bind("click",function(){return u.selectNode(a),function(e){_.net.loadHTML.call(this,"ide/uiide/ide_edit.html",r,function(){v(".modal-title").html("创建新文件"),v(".modal").modal("show"),s(r.find("form"),e,!1)})}(a),!1}),v("#editBtn_"+a.tId).bind("click",function(){return u.selectNode(a),o(a),!1})}},n.view.removeHoverDom=function(e,t){v("#addBtn_"+t.tId).unbind().remove(),v("#editBtn_"+t.tId).unbind().remove(),v("#remBtn_"+t.tId).unbind().remove()},a.empty(),t?u=v.fn.zTree.init(a,n,t):m("/",function(e){u=v.fn.zTree.init(a,n,e)})}function z(e,t,a){_.net.loadScript.call(this,n,function(){k=r(t,a),e&&e()})}var k,s,e=function(e){function b(e,a,t){var n={};v.extend(!0,n,_.g.comm),n.path=e,C._api("getfilelist",function(e){if(Boolean(e.ret))_.ui.msg("提示","接口执行失败:"+e.msg,"e");else{var t=e.result;v.isArray(t)?t=i(t):t.children=i(t.children),a&&a(t)}},n)}function i(e){var a=[],n=[];return v.each(e,function(e,t){t.isParent?n.push(t):a.push(t)}),[].concat(n,a)}function o(){var a=!0,e=_.cache.get("_zy_user_info","ls"),n=_.g.comm.org,t=e.get("user_org_list");return v.each(t,function(e,t){t.orgid==n&&(a=t.isplatorg)}),a}function t(){var e,t,a,n,i=d.find(".jarviswidget-editbox"),l=C._label("div").addClass("row");l.append((e=function(t){k&&k.contentid&&(t.btnDisable(!0),C._api({apiid:"ucode",r_param:{contentid:k.contentid,content:k.get(),updatecmt:""}},function(e){Boolean(e.ret)?_.ui.msg("提示","接口执行失败:"+e.msg,"e"):(t.btnDisable(!1),_.ui.msg("提示信息","文件保存成功","s"))}))},t=C._label("a").addClass("btn btn-labeled btn-success pull-right").attr("href","javascript:void(0);").css("margin-right","17px"),a=C._label("span").addClass("btn-label"),n=C._label("i").addClass("glyphicon glyphicon-ok"),t.append(a.append(n)).append("提交"),t.click(function(){e&&e(v(this))}),t)),i.append(l)}var d=v("#"+e),m=C._label("div");m._form=function(e,t,a){var n,i,l,d,r=v.extend(!0,{},t),s=(n=r,i=[],l=[],d=[],v.each(n,function(e,t){12===t.width?l.push(t):"createdt"===t.id||"updatedt"===t.id?d.push(t):i.push(t)}),{half:i,full:l,time:d});function o(e){if(12!==e.width)var t=C._label("section").addClass("col col-"+e.width);else t=C._label("section");var a=C._label("label").addClass("label").html(e.name);if("textarea"===e.type)var n=C._label("label").addClass("textarea has-warning"),i=C._label("textarea").attr("name",e.id).attr("placeholder",e.name);else n=C._label("label").addClass("input has-warning"),i=C._label("input").attr("name",e.id).attr("type",e.type).attr("placeholder",e.name);"select2"===i.attr("type")&&i.attr("type","input"),e.write||i.attr("readonly","readonly");var l=C._label("b").addClass("tooltip tooltip-bottom-right").html(e.name+"为必填项");return n.append(i).append(l),t.append(a).append(n),t}function p(e){var t=e/2;return Math.round(t)===t}var c=C._label("form").attr("onsubmit","return false;").addClass("smart-form");c.append(v("<fieldset></fieldset>")),v.each(s.half,function(e,t){var a=e/2;if(p(e)){var n=C._label("div").addClass("row");c.children().append(n)}else a-=.5;c.find("div").eq(a).append(o(t))});var h,u,m,f,g,b=null;v.each(s.time,function(e,t){p(e)&&(b=C._label("div").addClass("row")),b.append(o(t)),c.children().append(b)}),v.each(s.full,function(e,t){c.children().append(o(t))}),h=c,u=C._label("footer"),m=C._label("button").addClass("btn btn-default").attr("data-dismiss","modal").html("取消"),f=C._label("button").addClass("btn btn-primary").attr("name","ide_submit").html("确定"),u.append(m).append(f),h.append(u),g=r,v.each(g,function(e,t){"status"===t.id&&_.cache.initDicts("ZR.0001",function(){c.find("[name="+t.id+"]").zySelect("ZR.0001",!1,{allowClear:!1,width:"100%"}),c.find("[name="+t.id+"]").select2("val","1")}),"auflag"===t.id&&_.cache.initDicts("ZR.0029",function(){c.find("[name="+t.id+"]").zySelect("ZR.0029",!1,{allowClear:!1,width:"100%"}),c.find("[name="+t.id+"]").select2("val","0")}),"optype"===t.id&&_.cache.initDicts("ZR.0010",function(){c.find("[name="+t.id+"]").zySelect("ZR.0010",!1,{allowClear:!1,width:"100%"}),c.find("[name="+t.id+"]").select2("val","0")})}),e.append(c),a&&v.each(a,function(e,t){c.find("[name="+e+"]").val(t)})};var a=C._label("div").addClass("row"),n=C._label("div").addClass("col-xs-12 col-sm-9").css({});n.unbind(),n.bind("size",function(e){v(this).removeClass();var t=v(this).siblings(":visible");if(0<t.length){var a=0;v.each(t,function(e,t){a+=Number(v(t).attr("class").replace(/col-xs-12 col-sm-/g,""))}),v(this).addClass("col-xs-12 col-sm-"+(12-a))}else v(this).addClass("col-xs-12 col-sm-12")});var l,r,s,p,c,h,u,f=C._label("pre").attr("id","zy_ide_editor"),t=C._label("div").addClass("col-xs-12 col-sm-3").css({display:"none"}),g=function(){var e,t,a,n=C._label("div").addClass("col-xs-12 col-sm-3");e=n,t=C._label("div").addClass("input-group input-group-sm").attr("style","width:100%;margin-bottom:-15px"),(a=C._label("header")).append(C._label("label").html("文件目录")).append(C._label("a").attr("href","javascript:void(0);").addClass("pull-right").append(C._label("i").addClass("fa fa-times"))),e.append(t.append(a)),e.append(C._label("legend")),a.children("a").unbind(),a.children("a").click(function(){var e=v(this).closest(".col-sm-3");e.hide(),e.parent().children(":eq(1)").trigger("size")});var i=C._label("ul").addClass("ztree").attr("id","maintree");return n.append(C._label("div").attr("style","overflow: auto; height: 100%;").addClass("row").css("margin-top","-15px").append(i)),{container:n,ul:i}}();return d.closest("#widget-grid").after(m),f.attr("style","font-family:Consolas,Microsoft YaHei,微软雅黑,sans-serif,宋体;top:-14;height:100%; width:100%;"),a.append(g.container).append(n).append(t),d.find(".widget-body").empty().append(a),(l=d.children("header")).append(function(){function e(){var e=v("#zy_tabs").closest(".row").children(":last"),t=!1;0<v("#jarviswidget-fullscreen-mode").length&&(t=!0),function(e,t){var a,n;e.empty(),a=C._label("div").addClass("input-group input-group-sm").attr("style","width:100%;margin-bottom:-15px"),(n=C._label("header")).append(C._label("label").html("文件上传")).append(C._label("a").attr("href","javascript:void(0);").addClass("pull-right").append(C._label("i").addClass("fa fa-times"))),e.append(a.append(n)),e.append(C._label("legend")),n.children("a").unbind(),n.children("a").click(function(){var e=v(this).closest(".col-sm-3");e.hide(),e.parent().children(":eq(1)").trigger("size")});var i=C._label("form").attr("id","uploadform").attr("onsubmit","return false;"),l=C._label("ul").addClass("ztree").attr("id","resulttree"),d=C._label("div").attr("style","margin:-10px 0-5px");e.append(i);var r=v.fn.zTree.getZTreeObj("maintree").getSelectedNodes(),s="/";r[0]&&(s=r[0].isParent?r[0].path:r[0].getParentNode().path);var o=C._label("input").addClass("form-control").attr("type","text").attr("readonly",!0).attr("name","path").val(s),p=C._label("button").addClass("btn btn-primary").html("开始上传");e.append(C._label("legend"));var c=C._label("a").attr("href","javascript:void(0);").addClass("pull-right").append(C._label("i").addClass("fa fa-times")).attr("style","margin-right:13px"),h="overflow:auto;display:none;height:";t&&(h="overflow:auto;display:none;height:"),h=w-400+"px",e.append(C._label("div").addClass("row").attr("style",h).append(l)),d.append(C._label("label").html("上传到:")).append(o);var u=C._label("div").addClass("input-group input-group-sm");i.append(d).append(C._label("legend")),i.append(u).append(C._label("legend"));var m,f=C._label("span").addClass("input-group-btn");function g(){var e=C._label("input").attr("type","file").attr("name","file");return u.append(e),e}f.append(p),i.append(f),g(),v("<button class='btn btn-default'>增加文件</button>").appendTo(f).click(function(){g().click()}),v("<button class='btn btn-default'>重置表单</button>").appendTo(f).click(function(){u.empty(),g()}),(m=c).unbind(),m.click(function(){var e=v(this).closest("div");e.hide(),e.next().hide(),e.prev().hide()}),function(d,r){if(d){d.unbind();var t=v("#zy_tabs").closest(".row").children(":last");d.click(function(){var i=t.find("[type=text]").val();if(i&&v("input[type=file]").val()){var l=v("input[type=file]").val().toLowerCase(),e=l.split(".").length;l.split(".")[e-1],b(i,function(e){var t,a=e;t=v.isArray(a)?a:a.children;var n=!1;v.each(t,function(e,t){var a=t.name.toLowerCase();if(l==a)return!(n=!0)}),n?_.ui.msg("提示信息","存在","e"):(d.attr("disabled",!0).text("正在上传..."),C._formPost("uploadfile",r,function(e){d.removeAttr("disabled").text("开始上传"),0===e.code?(_.ui.msg("提示信息",e.msg||"成功","s"),b(i,function(e){var t=v.fn.zTree.getZTreeObj("maintree"),a=t.getNodesByParam("path",i)[0],n=e;v.isArray(n)?a.children=n:a.children=n.children,a.open=!0,t.refresh()})):_.ui.msg("失败",e.msg,"e")}))})}else _.ui.msg("提示信息","文件路径及文件不可为空","w")})}}(p,i)}(e,t),e.show(),v("#zy_tabs").parent().trigger("size")}function t(){var t,e,a,n=v("#zy_tabs").closest(".row").children(":last");v("#jarviswidget-fullscreen-mode").length,n.attr("style","right:10px"),(t=n).empty(),e=C._label("div").addClass("input-group input-group-sm").attr("style","width:100%;margin-bottom:-15px"),(a=C._label("header")).append(C._label("label").html("查看历史")).append(C._label("label").attr("name","historyname")).append(C._label("a").attr("href","javascript:void(0);").addClass("pull-right").append(C._label("i").addClass("fa fa-times"))),t.append(e.append(a)),t.append(C._label("legend")),a.children("a").unbind(),a.children("a").click(function(){var e=v(this).closest(".col-sm-3");e.hide(),e.parent().children(":eq(1)").trigger("size")}),t.append(C._label("div").addClass("row").attr("style","margin-top:-10px;overflow:auto;height:100%").attr("name","result")),function(){var e=v("pre:visible").parent().attr("name");if(o())var a="$/t/paas"+e;else var a="$/t/saas/"+_.g.comm.org+e;var n=v("pre:visible").attr("name"),i=v("pre:visible").attr("id");null==e?t.find("[name=result]").append(v("<center>").append("没有目标文件")):C._apis("hist",function(e){e&&(t.find("[name=historyname]").html("("+n+")"),t.find("[name=result]").append(e),t.find("[name=result]").find("h3").empty(),t.find("[name=result]").find("a").each(function(e,t){v(t).attr("href","javascript:void(0);"),v(t).unbind().bind("click",function(){$a=v(this);var d,r,e,s,o,t=$a.siblings("b").text();d=a,r=$a,e=t,s=n,o=i,C._apis("cont",function(e){var t=v("#widget-grid").find("header .glyphicon-saved").parent(),a=s+" "+r.html(),n=o+r.html(),i=j.add(a,d,n);i.inputc.val("");var l=s.split(".")[1];z(function(){t.hide(),k.set(e.data,!1),k.initSize()},i.pre,l)},{f:d,d:r.html(),i:e,js:1})})})),0==t.find("ul").children().length&&t.find("[name=result]").append(v("<center>").append("空"))},{f:a})}(),n.show(),v("#zy_tabs").parent().trigger("size")}function a(){var e=v("#zy_tabs").closest(".row").children(":last"),t=!1;0<v("#jarviswidget-fullscreen-mode").length&&(t=!0),function(e,t){var a,n;e.empty(),a=C._label("div").addClass("input-group input-group-sm").attr("style","width:100%;margin-bottom:-15px"),(n=C._label("header")).append(C._label("label").html("按文件内容查询")).append(C._label("a").attr("href","javascript:void(0);").addClass("pull-right").append(C._label("i").addClass("fa fa-times"))),e.append(a.append(n)),e.append(C._label("legend")),n.children("a").unbind(),n.children("a").click(function(){var e=v(this).closest(".col-sm-3");e.hide(),e.parent().children(":eq(1)").trigger("size")});var i=C._label("ul").addClass("ztree").attr("id","resulttree").attr("name","resulttree"),l=C._label("div").addClass("smart-form").attr("style","margin-top:-10px");e.append(l),e.append(C._label("legend"));var d=C._label("textarea ").attr("placeholder","内容").attr("rows","3"),r=(C._label("_label").addClass("glyphicon glyphicon-search").attr("rel","tooltip").attr("title","查询"),C._label("button").addClass("btn btn-default btn-xs pull-right").attr("style","margin-top:5px;margin-right:14px").html("查询")),s=C._label("i").addClass("fa fa-times pull-right").attr("style","margin-right:13px"),o=C._label("label").addClass("toggle state-error pull-left").attr("style","margin:4px 0 0 5px");o.append(C._label("input").attr("type","checkbox").attr("checked",1)).append(C._label("i").attr({"data-swchoff-text":"off","data-swchon-text":"on",title:"区分大小写"})),e.append(C._label("div").addClass("row").attr("style","margin-top:-10px;display:none").append(C._label("h").attr("style","margin-left:20px").html("查询结果")).append(s));var p,c,h,u="overflow:auto;display:none;height:";t&&(u="overflow:auto;display:none;height:"),u+=w-400+"px",e.append(C._label("div").addClass("row").attr("style",u).append(i)),l.append(C._label("label").addClass("textarea").append(d)),l.append(C._label("div").addClass("row").attr("style","margin-bottom:-10px").append(o).append(r)),(h=s).unbind(),h.click(function(){var e=v(this).closest("div");e.hide(),e.next().hide(),e.prev().hide()}),p=r,c=o.children("input"),(p||c)&&(p.unbind(),p.click(function(){var e=c.prop("checked"),t={content:d.val(),casesensitive:e};C._api("search",function(e){Boolean(e.ret)?_.ui.msg("提示","接口执行失败:"+e.msg,"e"):(i.siblings().remove(),i.empty(),0===e.result.children.length?i.parent().append(C._label("div").css({"text-align":"center","vertical-align":"middle"}).html("空")):x({tree:{ztree:i},mod:m},e.result),i.parent().siblings(":hidden").show(),i.parent().show())},v.extend(!0,t,_.g.comm))}))}(e,t),e.show(),v("#zy_tabs").parent().trigger("size")}function n(){var e=v("#zy_tabs").closest(".row").children(":last"),t=!1;0<v("#jarviswidget-fullscreen-mode").length&&(t=!0),function(e,t){var a,n;e.empty(),a=C._label("div").addClass("input-group input-group-sm").attr("style","width:100%;margin-bottom:-15px"),(n=C._label("header")).append(C._label("label").html("按文件名查询")).append(C._label("a").attr("href","javascript:void(0);").addClass("pull-right").append(C._label("i").addClass("fa fa-times"))),e.append(a.append(n)),e.append(C._label("legend")),n.children("a").unbind(),n.children("a").click(function(){var e=v(this).closest(".col-sm-3");e.hide(),e.parent().children(":eq(1)").trigger("size")});var i=C._label("ul").addClass("ztree").attr("id","resulttree").attr("name","resulttree"),l=C._label("div").addClass("input-group input-group-sm").attr("style","margin:-10px 0-5px");e.append(l),e.append(C._label("legend")),l.append(C._label("span").addClass("input-group-addon"));var d=C._label("input").addClass("form-control").attr("placeholder","查询").attr("type","text"),r=C._label("_label").addClass("glyphicon glyphicon-search").attr("rel","tooltip").attr("title","查询"),s=C._label("button").addClass("btn btn-default").html("查询"),o=C._label("a").attr("href","javascript:void(0);").addClass("pull-right").append(C._label("i").addClass("fa fa-times")).attr("style","margin-right:13px");e.append(C._label("div").addClass("row").attr("style","margin-top:-10px;display:none").append(C._label("h").attr("style","margin-left:20px").html("查询结果")).append(o));var p,c,h="overflow:auto;display:none; height:";t&&(h="overflow:auto;display:none; height:"),h+=w-300+"px",e.append(C._label("div").addClass("row").attr("style",h).append(i)),l.append(C._label("div").addClass("icon-addon addon-sm").append(d).append(r)),l.append(C._label("span").addClass("input-group-btn").append(s)),(c=o).unbind(),c.click(function(){var e=v(this).closest("div");e.hide(),e.next().hide(),e.prev().hide()}),(p=s)&&(p.unbind(),p.click(function(){var e={};e.content=d.val(),C._api("search",function(e){Boolean(e.ret)?_.ui.msg("提示","接口执行失败:"+e.msg,"e"):(i.siblings().remove(),i.empty(),0===e.result.children.length?i.parent().append(C._label("div").css({"text-align":"center","vertical-align":"middle"}).html("空")):x({tree:{ztree:i},mod:m},e.result),i.parent().siblings(":hidden").show(),i.parent().show())},v.extend(!0,e,_.g.comm))}))}(e,t),e.show(),v("#zy_tabs").parent().trigger("size")}var i,l,d=C._label("div").attr("role","menu").addClass("widget-toolbar").attr("title","功能表"),r=C._label("i").addClass("fa fa-align-justify dropdown-toggle").attr("data-toggle","dropdown"),s=C._label("ul").addClass("dropdown-menu pull-right");return d.append(C._label("div").addClass("btn-group").append(r).append(s)),i=[{id:"byid",name:"按文件名称查找"},{id:"bycontent",name:"按文件内容查找"},{id:"fileinput",name:"上传文件"},{id:"history",name:"查看历史"}],l=s,v.each(i,function(e,t){var a=C._label("li").append(C._label("a").html(t.name)).attr("id",t.id);l.append(a)}),s.children().unbind(),s.children().click(function(){"byid"===v(this).attr("id")&&n(),"bycontent"===v(this).attr("id")&&a(),"fileinput"===v(this).attr("id")&&e(),"history"===v(this).attr("id")&&t()}),d}()),l.append((r=C._label("div").attr("role","menu").addClass("widget-toolbar").attr("style","display:none;").attr("title","保存"),(s=C._label("i").addClass("glyphicon glyphicon-saved")).unbind(),s.click(function(){m.empty();var e=v("#zy_tabs").children("div:visible").find("pre").attr("id"),t=v("#zy_tabs").children("div:visible").find("div").attr("name"),a=ace.edit(e);if(y(a),v("#left-panel nav").bind("click",function(){a.destroy(),a.container.remove()}),a&&t){v(this).btnDisable(!0);var n={path:t,content:a.getValue().trim(),reason:""};_.g.am.app="ZYAPP_IDE",_.g.am.mod="uiidemod",_.net.get("api/save_remove",function(e){"0"==e.ret&&C._post("savefile",function(e){v(this).btnDisable(!1),_.ui.msg("保存文件",e.msg,0!=parseInt(e.ret)?"e":"s"),v(".modal").modal("hide")},v.extend(!0,n,_.g.comm))},null)}}),r.append(s))),l.append(function(){var e=C._label("div").attr("role","menu").addClass("widget-toolbar").attr("style","display:none;").attr("title","更改状态");e.append(C._label("div").addClass("btn-group"));var t=C._label("i").addClass("glyphicon glyphicon-cloud-upload dropdown-toggle").attr("data-toggle","dropdown"),a=C._label("ul").addClass("dropdown-menu pull-right");return e.unbind("show"),e.bind("show",function(e,t){}),e.children().append(t).append(a).parent()}()),l.append((p=C._label("div").attr("role","menu").addClass("widget-toolbar").attr("title","文件目录"),(c=C._label("i").addClass("glyphicon glyphicon-folder-open")).unbind(),c.click(function(){g.container.is(":visible")?(v(this).children().removeClass().addClass("glyphicon glyphicon-chevron-right"),g.container.hide()):(v(this).children().removeClass().addClass("glyphicon glyphicon-chevron-left"),g.container.show()),v("#zy_tabs").parent().trigger("size")}),p.append(c))),l.append((h=C._label("div").attr("role","menu").addClass("widget-toolbar").attr("style","display:none;").attr("title","预览"),(u=C._label("i").addClass("glyphicon glyphicon-play")).unbind(),u.click(function(){var e,t=v("#zy_tabs").children("div:visible").find("div").attr("name").replace(/^\//,"");_.cache.get("_zy_user_info","ls").get("user_selected_org_path"),_.isXBosonSystem?e=t.startsWith("web/")?_.g.host.ui+"/"+t:_.g.host.ui+"/t/"+(o()?"paas":"saas/"+_.g.comm.org)+"/emptymain.html#"+t:(e="http://"+location.host+"/t/",e+=o()?"paas":"saas/"+_.g.comm.org,e+="/emptymain.html#"+t),_.log("window.open  _u == "+e),window.open(e,"")}),h.append(u))),{wid:d,tree:{ztree:g.ul,container:g.container,sResultCon:g.sResult},pre:n,mod:m,result:t}}("ide"),j=function(i){function c(e){e.click(function(){var e=v("#widget-grid").find("header .glyphicon-cloud-upload").closest(".widget-toolbar"),t=i.wid.children("header").find(".glyphicon-saved").parent(),a=i.wid.children("header").find(".glyphicon-play").parent(),n=i.wid.children("header").find(".glyphicon-sort").parent();1==h.getCount()&&(m(!1),e.hide(),t.hide(),a.hide(),n.hide())})}function e(){var a=v("#widget-grid").find("header .glyphicon-play").parent();a.unbind("visible"),a.bind("visible",function(e,t){f[t]?a.show():a.hide()});var n=v("#widget-grid").find("header .glyphicon-saved").parent();n.unbind("historyvisible"),n.bind("historyvisible",function(e,t){1==t.length?n.show():n.hide()}),h.el.on("tabsbeforeactivate",function(e,t){var a=t.newPanel.children().children(),n=v("#widget-grid").find("header .glyphicon-cloud-upload").closest(".widget-toolbar"),i=v("#widget-grid").find("header .glyphicon-saved").parent(),l=a.attr("name").split(".")[1];v("#widget-grid").find("header .glyphicon-play").parent().trigger("visible",[l]);var d=a.children().attr("name").split(" ");i.trigger("historyvisible",[d]),a.attr("name")?n.trigger("show",[a.attr("stability")]):(i.hide(),n.hide())})}var t=i.pre,h=new zyTabs(t);return e(),{add:function(e,t,a,n,i){m(!0);var l=C._label("input").addClass("form-control").attr("readonly","readonly");if(/^(png)|(jpg)|(jpeg)|(gif)|(ico)/.test(n)){var d=C._image("img");d.attr("src",i).css("z-index",9999).css("max-height","380px").css("max-width","380px");var r=C._label("pre");r.attr("style","background-color:white;border:0").attr("id",a).attr("name",e).addClass("fix_size");var s=C._label("div").addClass("row").css("height",w-u).append(r.append(d)).addClass("fix_size")}else{var o=C._label("pre");o.attr("style","font-family:Consolas,Microsoft YaHei,微软雅黑,sans-serif,宋体;top:-14;height:100%; width:100%;").attr("id",a).attr("name",e).addClass("fix_size"),s=C._label("div").addClass("row").css("height",w-u).append(o).addClass("fix_size")}t&&s.attr("name",t);var p=h.AddTab(a,e,!0,s);return p?(h.active(p),{pre:h.el.find("[aria-hidden=false]").find("pre"),inputc:l}):(c(h.el.find("li[aria-selected=true]").find(".hover-transparent:has(i)")),{pre:o,inputc:l})},eventOn:e,delbtn:c}}(e);!function(){var e=navigator.userAgent.toLowerCase(),t="ipad"==e.match(/ipad/i),a="iphone os"==e.match(/iphone os/i),n="midp"==e.match(/midp/i),i="rv:1.2.3.4"==e.match(/rv:1.2.3.4/i),l="ucweb"==e.match(/ucweb/i),d="android"==e.match(/android/i),r="windows ce"==e.match(/windows ce/i),s="windows mobile"==e.match(/windows mobile/i);if(t||a||n||i||l||d||r||s){var o=window.screen.height;v("article").attr("style","overflow: auto;height:"+o+"px;"),v(window).resize(function(){v("article").attr("style","overflow: auto;height:"+o+"px;")})}}(),x(e),pageSetUp(),s=e,v("#left-panel a[href]").one("click",function(){window.onbeforeunload=null,v(window).unbind("resize")}),s.tree.container,v("#zy_tabs").parent(),s.wid.find(".jarviswidget-fullscreen-btn").click(function(){var e;if(s.result.find("div:has(ul)"),v("#zy_tabs").find("div.row:has(pre)"),v("#zy_tabs").find("p").children(),0!=v("pre").length)var t=v("#zy_tabs").children("div:visible").find("pre"),a=v("#zy_tabs").children("div:visible").find("pre").attr("id"),n=v("#zy_tabs").children("div:visible").find("pre").attr("name"),i=n.split(".").length,l=n.split(".")[i-1];v("pre"),e=0<v("#jarviswidget-fullscreen-mode").length?(/^(png)|(jpg)|(jpeg)|(gif)|(ico)/.test(l)?v("img").each(function(e,t){}):0!=v("pre").length&&(k=ace.edit(a),v("#left-panel nav").bind("click",function(){k.destroy(),k.container.remove()}),k.setOption("wrap",120),k.setOption("tabSize",2),y(k),r(t,l)),(e=v(v(".col-xs-12.col-sm-3")[0]).children(":last").attr("style")).replace(/552/,"440")):(/^(png)|(jpg)|(jpeg)|(gif)|(ico)/.test(l)?v("img").each(function(e,t){}):0!=v("pre").length&&(k=ace.edit(a),v("#left-panel nav").bind("click",function(){k.destroy(),k.container.remove()}),k.setOption("wrap",120),k.setOption("tabSize",2),y(k),r(t,l)),(e=v(v(".col-xs-12.col-sm-3")[0]).children(":last").attr("style")).replace(/440/,"552")),v(v(".col-xs-12.col-sm-3")[0]).children(":last").attr("style",e)})}(jQuery,zy);