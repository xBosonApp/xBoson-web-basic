<!-- rbac_prj_mgt02 项目widget -->
<div class="jarviswidget" data-widget-colorbutton="false" data-widget-editbutton="false">
  <header>
    <h2></h2>
    <div role="menu" id="edit_project" class="widget-toolbar" style="" title="修改"><i class="fa fa-edit"></i></div>
  </header>
  <!-- widget div-->
  <div>
    <!-- widget edit box -->
    <div class="jarviswidget-editbox">
      <!-- This area used as dropdown edit box -->
    </div>
    <!-- end widget edit box -->
    <!-- widget content -->
    <div class="widget-body">
      <div class="tabs-left">
        <ul class="nav nav-tabs tabs-left">
          <li class="active">
            <a data-toggle="tab" href="#tab-r1">基本信息 </a>
          </li>
          <li>
            <a data-toggle="tab" href="#tab-r2">API 管理 </a>
          </li>
          <li>
            <a data-toggle="tab" href="#tab-r4">菜单管理 </a>
          </li>
          <li> 
            <a data-toggle="tab" href="#tab-r5">页面管理 </a>
          </li> 
          <li>
            <a data-toggle="tab" href="#tab-r3">人员管理 </a>
          </li>
          <li>
            <a data-toggle="tab" href="#tab-r6">API历史</a>
          </li>
        </ul>
        <div class="tab-content">
          <div id="tab-r1" class="tab-pane active">
            <div class="row">
              <div class="col-sm-10">
                <h1><span id="projectName" class="semi-bold"></span></h1>
                <br>
                <ul class="list-unstyled">
                  <li>
                    <p class="text-muted">
                      <i class="fa fa-calendar"></i>&nbsp;&nbsp;
                      <span class="txt-color-darken">
                        创建时间
                        <p id="createdt" data-original-title="创建时间" data-placement="top" title="" rel="tooltip" style="cursor:default;"></p>
                      </span>
                    </p>
                  </li>
                </ul>
                <br>
                <p class="font-md">
                  <i>项目描述</i>
                </p>
                <p id="projectDe"></p>
                <br>
                <div>
                  <div class='row export_import_div'>
            			  <form action='/03229cbe4f4f11e48d6d6f51497a883b/XMGL/import' class='fix_action_url'
            			        method="post" enctype="multipart/form-data">
                      <input type='hidden' name='prjid'/>
                	    <input type="file" name="file"/>
                      <input type="submit" value="导入" id='menu_imports'/>
                	  </form>
                	  <form action='/03229cbe4f4f11e48d6d6f51497a883b/XMGL/export' id='menu_exports' 
                	        class='fix_action_url'>
                	    <input type='submit' value='导出'/>
                	    <input type='hidden' name='prjid'/>
                	  </form>
                	  <!--<iframe name='upload_file_form_target' src=''></iframe>-->
            			</div>
                </div>
              </div>
            </div>
          </div>
          <div id="tab-r2" class="tab-pane">
            <div class="row">
              <div class="col-xs-9">
                <ul id="apilist" class="ztree"></ul>
              </div>
              <div class="col-xs-3">
                <button class="btn btn-default dropdown-toggle" data-toggle="dropdown">API&nbsp;操作&nbsp;<span
                  class="caret"></span></button>
                <ul class="dropdown-menu">
                  <li>
                    <a href="javascript:void(0);" id="up">上线</a>
                  </li>
                  <li>
                    <a href="javascript:void(0);" id="down">下线</a>
                  </li>
                  <li>
                    <a href="javascript:void(0);" id="redit">转开发</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div id="tab-r4" class="tab-pane">
            <div id="prj_menu"></div>
          </div>
          <div id="tab-r5" class="tab-pane">
            <div id="prj_page"></div>
          </div>
          <div id="tab-r3" class="tab-pane">
            <ul id="rolegroup" class="ztree"></ul>
          </div>
          <div id="tab-r6" class="tab-pane">
            <fieldset>
              <section>
                <h6>查询条件</h6>
              </section>
              <form id="rbac_prj_mgt02r6_form" method="post" onsubmit="return false;" class="smart-form"> 
                <div class="row">
                  <section class="col col-3">
                    <label class="input">
                      <input type="select2" name="appnm" placeholder="App名称" class="form-control input-sm">
                    </label>
                  </section>
                  <section class="col col-3">
                    <label class="input">
                      <input type="select2" name="modnm" placeholder="模块名称" class="form-control input-sm" readonly="readonly">
                    </label>
                  </section>
                  <section class="col col-3">
                    <label class="input">
                      <input type="select2" name="apinm" placeholder="Api名称" class="form-control input-sm" readonly="readonly">
                    </label>
                  </section>
                  <section class="col col-3">
                  <label class="input">
                    <input type="select2" name="apizt" placeholder="API状态" class="form-control input-sm">
                  </label>
                </section>
                </div>
                <div class="row">
                <!--<section class="col col-3">-->
                <!--  <label class="input">-->
                <!--    <input type="select2" name="kfz" placeholder="开发组/开发者" class="form-control input-sm">-->
                <!--  </label>-->
                <!--</section>-->
                <section class="col col-3">
                  <label class="input">
                    <input type="text" name="dtstart" placeholder="开始时间" class="form-control input-sm">
                  </label>
                </section>
                <section class="col col-3">
                  <label class="input">
                    <input type="text" name="dtend" placeholder="结束时间" class="form-control input-sm">
                  </label>
                </section>
                <section class="col col-3">
                  <button id="tab-r6-query" type="button" class="btn btn-sm btn-primary">查询</button>
                </section>
                </div>
              </form>
            </fieldset>
            <!--<div id="prj_api_history">-->
            <div class="table-responsive">
    			    <div class="pull-right" style="margin-top: 35px;margin-right: 15px;"><b name="total_count"></b></div>
            	<table name="prj_api_history_table" class="table table-bordered table-striped">
            	</table>
            </div>
            <div id="prj_api_history_pagination"></div>
            <!--</div>-->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<style>
  .export_import_div { border: 1px dashed #ccc; padding: 0 10px; margin: 10px 0px 0 0px; }
  .export_import_div form, .export_import_div input { display: inline-block; }
  .export_import_div iframe { border:0; margin:0; padding: 2px; display: inline-block; max-height: 4em;
      vertical-align: middle; width: 50%; }
</style>

<script type="text/javascript">
// 项目导入/导出脚本 
$(function() {
  
$('.fix_action_url').each(function() {
  var form = $(this);
  if (form.data("fix_url")) return;
  
  var url = [zy.g.host.api, 'app/', zy.g.comm.org, form.attr("action"), '?'];
  if (zy.debug) {
    form.append("<input name='s' value='d' type='hidden'>");
    url.push("s=d");
  }
  form.attr('action', url.join(''));
  form.data("fix_url", true);
  
  form.one("submit", function() {
    var url = form.attr('action');
    if (url.indexOf("prjid") < 0) {
      var prjid = form.find("[name=prjid]").val();
      form.attr('action', url + "&prjid="+ prjid);
    }
  });
});


if (!window.rbac_export_index) window.rbac_export_index = 1;
$(".export_import_div").each(function() {
  let thiz = $(this);
  if (thiz.data("fix_target")) return;
  
  let name = 'upload_file_form_target_' + rbac_export_index;
  // iframe 的 name 不能动态绑定, 创建时定死
  let iframe = $("<iframe src='' name='"+ name +"'>").appendTo(thiz);
  thiz.find("form").prop("target", name);
  ++rbac_export_index;
  thiz.data("fix_target", true);
});

});
</script>