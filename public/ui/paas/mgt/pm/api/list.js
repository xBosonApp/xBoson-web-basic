ApiProcessManager=function(){var t,a=l.prototype;a._g={page:1,count:1};var e,n=$("#log_access_log_wid"),o=$("#log_access_log_search_form"),i=$("#log_access_log_dt");function l(){return(t=this).Init(),this}function c(a,t){return a.beginAt-t.beginAt}return a.Events={},a.Init=function(){t.Select(),t.Toolbar(),t.Pagination(1),$("#log_access_log_kill").btnDisable(!0),$("#log_access_log_kill").click(function(){zy.g.am.app="e0ef1b25da204227b305fd40382693e6",zy.g.am.mod="api_manager";var a={pid:e.processId,nid:e.nodeID};zy.net.get("api/kill",function(a){$("#log_access_log_kill").btnDisable(!0),zy.ui.msg("结束进程",a.msg,"i"),t.UpDt()},a)})},a.DataTable=function(a){var t={data:a,columns:[{render:function(a,t,e,n){return(o=e.runningTime)<1e3?o.toFixed(1)+" 毫秒":(o/=1e3)<60?o.toFixed(1)+" 秒":(o/=60)<60?o.toFixed(1)+" 分":(o/=60).toFixed(1)+" 小时";var o}},{data:"nodeID"},{data:"api"},{data:"mod"},{data:"app"},{data:"org"},{data:"callUser"},{data:"processId"},{render:function(a,t,e,n){return new Date(e.beginAt).toLocaleString()}}]};$.extend(t,zy.ui.dataTable),i.dataTable(t)},a.Toolbar=function(){o.validate({rules:{},submitHandler:function(a){$("#log_access_log_search").button("loading"),t.Pagination(1)},errorPlacement:function(a,t){a.insertAfter(t.parent())}}),i.on("click","tr",function(a){if($(this).find("th").is("th")||$(this).find("td").hasClass("dataTables_empty"))return $("#log_access_log_kill").btnDisable(!0),e=null,!1;$("#log_access_log_kill").btnDisable(!1),i.DataTable().$("tr.active").removeClass("active"),$(this).addClass("active"),e=i.DataTable().row(".active").data()})},a.Pagination=function(a){zy.log("Pagination page = "+a),$.jqPaginator("#log_access_log_pagination",{totalCounts:t._g.count,pageSize:zy.g.page.pagesize,currentPage:a,onPageChange:function(a){zy.log("onPageChange num = "+a),t.SetDt(a)}})},a.SetDt=function(a){zy.g.am.app="e0ef1b25da204227b305fd40382693e6",zy.g.am.mod="api_manager",zy.net.get("api/list",function(a){$("#log_access_log_search").button("reset"),a&&(a.list.sort(c),t._g.count=a.count,n.find("[name=total_count]").text("总数："+a.list.length),t.DataTable(a.list),t._g.count=1,t._g.page=1,$("#log_access_log_pagination").jqPaginator("destroy"),pageSetUp())},$("#log_access_log_search_form").serialize(),a)},a.UpDt=function(){t.Pagination(1)},a.SetRow=function(a){},a.Select=function(){},l}();