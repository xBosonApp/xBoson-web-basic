ClusterManager=function(){var e,t=o.prototype;t._g={page:1,count:1};var a=$("#log_access_log_wid"),n=$("#log_access_log_search_form"),l=$("#log_access_log_dt");function o(){return(e=this).Init(),this}function i(t,e){return t.beginAt-e.beginAt}return t.Events={},t.Init=function(){e.Select(),e.Toolbar(),e.Pagination(1)},t.DataTable=function(t){var e={data:t,columns:[{data:"osName",title:"操作系统"},{data:"osArch",title:"系统类型"},{data:"osVersion",title:"系统版本"},{data:"javaVendor",title:"Java 厂商"},{data:"javaVersion",title:"Java 版本"},{data:"nodeID",title:"运算节点 ID"},{title:"IP 地址",render:function(t,e,a,n){return a.ip?a.ip.join("<br/>"):""}},{data:"rpcPort",title:"RPC 端口"},{title:"开机时间",render:function(t,e,a,n){return new Date(a.startAt).toLocaleString()}},{title:"运行时长",render:function(t,e,a,n){return(o=Date.now()-a.startAt)<1e3?o.toFixed(1)+" 毫秒":(o/=1e3)<60?o.toFixed(1)+" 秒":(o/=60)<60?o.toFixed(1)+" 分":(o/=60).toFixed(1)+" 小时";var o}},{title:"状态",render:function(t,e,a,n){var o=a.nodeID,i=zy.g.host.api+"app/"+zy.g.comm.org+"/e0ef1b25da204227b305fd40382693e6/cluster/nodestate";return $.get(i,{nodeid:o},function(t){var e=l.find("[nodeid="+o+"]");0===t.code?e.text(t.state):e.text(t.msg)}),"<span nodeid='"+o+"'>加载中...</span>"}}]};$.extend(e,zy.ui.dataTable),l.dataTable(e)},t.Toolbar=function(){n.validate({rules:{},submitHandler:function(t){$("#log_access_log_search").button("loading"),e.Pagination(1)},errorPlacement:function(t,e){t.insertAfter(e.parent())}}),l.on("click","tr",function(t){if($(this).find("th").is("th")||$(this).find("td").hasClass("dataTables_empty"))return $("#log_access_log_kill").btnDisable(!0),null,!1;$("#log_access_log_kill").btnDisable(!1),l.DataTable().$("tr.active").removeClass("active"),$(this).addClass("active"),l.DataTable().row(".active").data()})},t.Pagination=function(t){zy.log("Pagination page = "+t),$.jqPaginator("#log_access_log_pagination",{totalCounts:e._g.count,pageSize:zy.g.page.pagesize,currentPage:t,onPageChange:function(t){zy.log("onPageChange num = "+t),e.SetDt(t)}})},t.SetDt=function(t){zy.g.am.app="e0ef1b25da204227b305fd40382693e6",zy.g.am.mod="cluster",zy.net.get("api/list",function(t){$("#log_access_log_search").button("reset"),t&&(t.list.sort(i),e._g.count=t.count,a.find("[name=total_count]").text("总数："+t.list.length),e.DataTable(t.list),e._g.count=1,e._g.page=1,$("#log_access_log_pagination").jqPaginator("destroy"),pageSetUp())},$("#log_access_log_search_form").serialize(),t)},t.UpDt=function(){e.Pagination(1)},t.SetRow=function(t){},t.Select=function(){},o}();