<div class="modal fade" id="process_plan_h2h3" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
          &times;
        </button>
        <h4 class="modal-title">应急事件</h4>
      </div>
      <div class="modal-body no-padding">
        <!-- FORM Start -->
        <form id="process_plan_h2h3_form" method="post" onsubmit="return false;" class="smart-form">
          <fieldset>
            <div class="row">
              <section class="col col-6">
                <label class="label">应急预案编码</label>
                <label class="input has-warning">
                  <input type="text" name="plancd" placeholder="应急预案编码" value="ERP_0005">
                  <b id="process_plan_h2h3_plancd" class="tooltip tooltip-bottom-right">应急预案编码为必填项目</b>
                </label>
              </section>
              <section class="col col-6">
                <label class="label">类别名称</label>
                <label class="input has-warning">
                  <label class="select">
                    <select name="plannm">
                      <option value="0">英特尔半导体（大连）有限公司供水保障应急预案</option>
                    </select><i></i>
                  </label>
                  <b class="tooltip tooltip-bottom-right">应急预案名称为必选项目</b>
                </label>
              </section>
            </div>
            <div class="row">
              <section class="col col-6">
                <label class="label">事件类别</label>
                <label class="select">
                  <select name="event_type">
                    <option value="0">水质</option>
                    <option value="1">管道</option>
                    <option value="2">生产</option>
                  </select><i></i>
                </label>
              </section>
              <section class="col col-6">
                <label class="label">事件内容</label>
                <label class="input">
                  <input type="text" name="event_content" placeholder="事件内容" value="供水水质保障">
                </label>
              </section>
            </div>
            <div class="row">
              <section class="col col-6">
                <label class="label">调度负责人</label>
                <label class="input">
                  <input type="text" name="dispatcher" placeholder="调度负责人" value="赵主任">
                </label>
              </section>
              <section class="col col-6">
                <label class="label">调度负责人电话</label>
                <label class="input">
                  <input type="text" name="dispatcher_tel" placeholder="调度负责人电话" value="13800000000">
                </label>
              </section>
            </div>
            <div class="row">
              <section class="col col-6">
                <label class="label">事件相关负责人</label>
                <label class="input">
                  <input type="text" name="event_responder" placeholder="调度负责人" value="孙主任">
                </label>
              </section>
              <section class="col col-6">
                <label class="label">事件相关负责人电话</label>
                <label class="input">
                  <input type="text" name="event_responder_tel" placeholder="事件相关负责人电话" value="13600000000">
                </label>
              </section>
            </div>
            <section>
              <label class="label">事件内容</label>
              <label class="input">
                <input type="text" name="event_content" placeholder="事件内容" value="淮河中路供水管道在20-1号路西侧破裂">
              </label>
            </section>
            <section>
              <label class="label">事件处理办法</label>
              <label class="input">
                <input type="text" name="event_event_solution" placeholder="事件内容" value="关闭淮河中路与20-1号路交叉路口的DN600阀门，由东侧的DN500管道供水。">
              </label>
              <!--<label class="textarea">-->
                <!--<textarea rows="4" name="event_solution" placeholder="事件处理办法">关闭淮河中路与20-1号路交叉路口的DN600阀门，由东侧的DN500管道供水。</textarea>-->
              <!--</label>-->
            </section>
            <section>
              <label class="label">操作</label>
              <label class="select">
                <select name="event_status">
                  <option value="0">待办</option>
                  <option value="1">接受</option>
                  <option value="2">已办</option>
                  <option value="3">结束</option>
                </select><i></i>
              </label>
            </section>
          </fieldset>
          <footer>
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="submit" class="btn btn-primary">确定</button>
          </footer>
        </form>
        <!-- FORM End -->
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!-- /.modal -->
<script type="text/javascript" src="lib/js/plugin/jquery-form/jquery.form.min.js"></script>
<!-- SCRIPTS ON PAGE EVENT -->
<script type="text/javascript">
  // DO NOT REMOVE : GLOBAL FUNCTIONS!
  pageSetUp();

  (function() {
    if (pp_index._g.param.flg == 'i') {
      //添加
      //$('#process_plan_h2h3_form').clearForm();
      $("#process_plan_h2h3_form select[name=plannm]").get(0).selectedIndex = 0;
      $("#process_plan_h2h3_form select[name=event_type]").get(0).selectedIndex = 0;
    } else if (pp_index._g.param.flg == 'u') {
      $('#process_plan_h2h3_form').formDisable(true);
      //修改
      var callback = function (msg) {
        $('#process_plan_h2h3_form').formDisable(false);
        if (msg) {
          Console.log("获取字典类型信息数据 = " + JSON.stringify(msg));
          $('#process_plan_h2h3_form').json2form(msg.result[0]);
        }
      };
      //设置参数
      var h2h3= {
          typecd: pp_index._g.param.typecd
      };
      zy.net.get("api/gettypeupt", callback, h2h3);
      $("#process_plan_h2h3_form input[name=typecd]").attr('readonly', true);
      $('#process_plan_h2h3_typecd').remove();
    }
  })();

  $('#process_plan_h2h3').modal('show');

  // Registration validation script
  $("#process_plan_h2h3_form").validate({
    // Rules for form validation
    rules: {
      typecd: {
        required: true,
        maxlength: 100
      },
      typenm: {
        required: true,
        maxlength: 100
      },
      shortkey: {
        maxlength: 100
      },
      gbtype: {
        maxlength: 100
      },
      gbversion: {
        maxlength: 100
      },
      mark: {
        maxlength: 200
      }
    },
    // 验证成功后保存
    submitHandler: function (form) {
      var callback = function (msg) {
        $('#process_plan_h2h3_form').formDisable(false);
        if (msg) {
          Console.log("保存成功 = " + JSON.stringify(msg));
          if (pp_index._g.param.flg == 'u') {
            pp_index.SetRow($('#process_plan_h2h3_form').form2json());
          }
          $('#process_plan_h2h3').modal('hide');
          zy.ui.msg("提示信息：", "保存成功！", "s");
        }
      };
      if (pp_index._g.param.flg == 'i') {
        zy.net.post("api/addtype", callback, $('#process_plan_h2h3_form').serialize());
      } else if (pp_index._g.param.flg == 'u'){
        zy.net.post("api/settype", callback, $('#process_plan_h2h3_form').serialize());
      }
      $('#process_plan_h2h3_form').formDisable(true);
    },
    // Do not change code below
    errorPlacement: function (error, element) {
      error.insertAfter(element.parent());
    }
  });
</script>