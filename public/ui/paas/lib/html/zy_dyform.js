var dyForm=function(h,y){var d={label:function(e){return y("<"+e+"></"+e+">")}},v={form:function(){var e=d.label("form");return e.addClass("smart-form").attr({onsubmit:"return false;",method:"post"}),e},fieldset:function(){return d.label("fieldset")},row:function(){var e=d.label("div");return e.addClass("row"),e},section:function(e){var t=d.label("section");if(!Boolean(e))return t;var a="col col-"+e;return t.addClass(a),t},labelForName:function(e){var t=d.label("label");return t.addClass("label").html(e),t},labelForContent:function(e){var t=d.label("label");return t.addClass(e),t},input:function(e,t,a,n,r){var i=d.label("input");switch(a){case"text":i.attr({type:"text",name:e,placeholder:t}),"1"==n&&i.attr("readonly",!0);break;case"select2_radio":i.attr({type:"hidden","data-type":"select2",name:e,placeholder:t}),"1"==n&&i.attr("readonly",!0);break;case"radio":i.addClass("radio"),i.attr({type:"radio",name:e});break;case"checkbox":i.addClass("checkbox"),i.attr({type:"checkbox",name:e});break;case"file":var l=d.label("div"),c=d.label("input"),o=d.label("input");o.attr("type","text"),c.attr({type:"file",name:e,onchange:"this.parentNode.nextSibling.value = this.value"}),l.addClass("button");break;case"hidden":i.attr({type:"hidden",name:e});break;case"date2":i.attr({type:"text",name:e,placeholder:t}),new_datepicker(i,r)}return i},textarea:function(e,t,a){var n=d.label("textarea");return n.attr({name:e,placeholder:t,rows:a}),n},button:function(e,t,a){var n=d.label("button");return n.addClass("btn btn-default"),n.attr({name:e}),n.html(t),n.unbind(),n.bind("click",function(e){a()}),n},footer:function(){return d.label("footer")}};function e(e,t,a){var n={date2:r,text:r,textarea:function(e){var t=v.section(0),a=v.labelForName(e.cn),n=v.labelForContent("textarea"),r=v.textarea(e.en,e.cn,3);t.append(a).append(n.append(r)),s.append(t)},select2_radio:function(a){var e=v.section(6),t=v.labelForContent("input"),n=v.labelForName(a.cn),r=v.input(a.en,a.cn,a.elemtype);if(e.append(n).append(t.append(r)),s.children("div:last").append(e),c=!0,o=h.cache.get("_zy_user_info","ls"),d=o.get("user_selected_org"),u=o.get("user_org_list"),y.each(u,function(e,t){t.orgid==d&&(c=t.isplatorg)}),c)h.cache.initDicts.call(this,a.dict,function(){var e="[name="+a.en+"]",t=p.find(e);t.zySelect(a.dict,!1,{width:"100%"})});else{var i=h.cache.get("_zy_user_info","ls"),l=i.get("user_selected_org");h.org.cache.initDicts(a.dict,l,function(){var e="[name="+a.en+"]",t=p.find(e);t.orgSelect(a.dict,l,!1,{width:"100%"})})}var c,o,d,u}};function r(e){var t=v.section(6),a=v.labelForName(e.cn),n=v.labelForContent("input"),r=function(e){var t;switch(e){case"yyyy":t=1;break;case"yyyy-mm":t=3;break;case"yyyy-mm-dd":case"":t=4}return t}(e.format),i=v.input(e.en,e.cn,e.elemtype,e.ro,r);t.append(a).append(n.append(i)),s.children("div:last").append(t)}if(e){var p=v.form(),s=v.fieldset(),i=v.footer(),l=v.button("submit","提交",function(){});l.attr("type","submit"),l.addClass("btn-primary");var c=v.button("cancle","取消",function(){a&&a()});c.attr("type","button"),p.append(s).append(i.append(c).append(l));var o,d,u,m,f=[],b=[];return y.each(e,function(e,t){"1"==t.view?f.push(t):b.push(t)}),y.each(f,function(e,t){var a=e;Math.round(a/2)==a/2&&v.row().appendTo(s);n[t.elemtype]&&n[t.elemtype](t)}),y.each(b,function(e,t){}),o=p,d=e,u=t,m={},y.each(d,function(e,t){var a,n=[];if("string"==typeof t.numrange&&(n=t.numrange.split(",")),1<n.length){var r=Number(n[0])-Number(n[1]);num=(a=r,Math.pow(10,Number(a))-1),m[t.en]={required:"1"==t.must,isDecimal:[0,num,n[1]],number:"DECIMAL"==t.datatype}}else!isNaN(t.numrange)&&t.numrange?m[t.en]={required:"1"==t.must,maxlength:Number(t.numrange),number:"DECIMAL"==t.datatype}:m[t.en]={required:"1"==t.must,number:"DECIMAL"==t.datatype}}),o.validate({rules:m,submitHandler:function(e){u&&u()},errorPlacement:function(e,t){e.insertAfter(t.parent())}}),p}h.ui.msg("提示","数据源异常","e")}function t(e,t,r){var a={text:function(e){var t=v.section(2),a=v.labelForContent("input"),n=v.input(e.en,e.cn,e.elemtype);t.append(a.append(n)),i.append(t)},textarea:function(e){var t=v.section(0),a=v.labelForName(e.cn),n=v.labelForContent("textarea"),r=v.textarea(e.en,e.cn,3);t.append(a).append(n.append(r)),i.append(t)},select2_radio:function(a){var e=v.section(2),t=v.labelForContent("input"),n=v.input(a.en,a.cn,a.elemtype);e.append(t.append(n)),i.append(e),r?h.cache.initDicts.call(this,a.dict,function(){var e="[name="+a.en+"]",t=i.find(e);t.zySelect(a.dict,!1,{width:"100%"})}):h.org.cache.initDicts.call(this,a.dict,h.g.comm.org,function(){var e="[name="+a.en+"]",t=i.find(e);t.orgSelect(a.dict,h.g.comm.org,!1,{width:"100%"})})}};if(e){var i=v.form(),n=v.button("search","&emsp;查 询&emsp;",function(){t()});return n.append(d.label("i").addClass("fa fa-search fa-1")),n.addClass("btn-sm"),n.addClass("btn-info"),n.addClass("btn-primary"),y.each(e,function(e,t){a[t.elemtype]&&a[t.elemtype](t)}),i.append(v.section(2).append(n)),i}h.ui.msg("提示","数据源异常","e")}return loadScript("bi/js/datetime_custom.js",function(){}),function(){this.searchform=t,this.modalform=e}}(zy,jQuery);