<!-- Modal -->
<div class="modal fade" id="mgt_add_upd_server" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
          &times;
        </button>
        <h4 class="modal-title">服务器信息（<span id="mgt_add_upd_server_title"></span>）</h4>
      </div>
      <div class="modal-body no-padding">
        <!-- FORM Start -->
        <form id="mgt_add_upd_server_form" method="post" onsubmit="return false;" class="smart-form">
          <fieldset>
            <div class="row">
              <label class="input">
                <input type="hidden" name="serverid">
            <!--  <section class="col col-6">
                <label class="label">服务器ID</label>
                <label class="input has-warning">
                  <input type="text" name="serverid" placeholder="服务器ID">
                  <b id="mgt_add_upd_serverid_b" class="tooltip tooltip-bottom-right">服务器ID为必填项目</b>
                </label>
              </section>-->
              <section class="col col-6">
                <label class="label has-warning">服务器名称</label>
                <label class="input has-warning">
                  <input type="text" name="servernm" placeholder="服务器名称">
                  <b class="tooltip tooltip-bottom-right">服务器名称为必填项目</b>
                </label>
              </section>
              <section class="col col-6">
                <label class="label">服务器描述</label>
                <label class="input">
                  <input type="text" name="server_desc" placeholder="服务器描述" />
                </label>
              </section>
            </div>
            <div class="row">
              <section class="col col-6">
                <label class="label has-warning">运行服务版本</label>
                <label class="input has-warning">
                  <input type="text" name="server_v" placeholder="运行服务版本">
                  <b class="tooltip tooltip-bottom-right">运行服务版本为必填项目</b>
                </label>
              </section>
              <section class="col col-6">
                <label class="label has-warning">服务器类型</label>
                <label class="input has-warning">
                  <input type="hidden" name="server_type" data-type="select2" placeholder="服务器类型">
                  <b class="tooltip tooltip-bottom-right">服务器类型为必填项目</b>
                </label>
              </section>
            </div>
            <div class="row">
              <section class="col col-6">
                <label class="label">服务器容器</label>
                <label class="input">
                  <input type="text" name="server_type_detail" placeholder="服务器容器">
                </label>
              </section>
              <section class="col col-6">
                <label class="label has-warning">内网IP</label>
                <label class="input has-warning">
                  <input type="text" name="inner_ip" placeholder="内网IP">
                  <b class="tooltip tooltip-bottom-right">内网IP为必填项目</b>
                </label>
              </section>
            </div>
            <div class="row">
              <section class="col col-6">
                <label class="label has-warning">内网端口</label>
                <label class="input has-warning">
                  <input type="text" name="inner_port" placeholder="内网端口">
                  <b class="tooltip tooltip-bottom-right">内网端口为必填项目</b>
                </label>
              </section>
              <section class="col col-6">
                <label class="label">外网IP</label>
                <label class="input">
                  <input type="text" name="outer_ip" placeholder="外网IP" />
                </label>
              </section>
            </div>
            <div class="row">
              <section class="col col-6">
                <label class="label">外网端口</label>
                <label class="input">
                  <input type="text" name="outer_port" placeholder="外网端口" />
                </label>
              </section>
              <section class="col col-6">
                <label class="label">MAC地址</label>
                <label class="input">
                  <input type="text" name="mac" placeholder="MAC地址" />
                </label>
              </section>
            </div>
            <div class="row">
              <section class="col col-6">
                <label class="label">所在系统分配CPU核心数</label>
                <label class="input">
                  <input type="text" name="cpu_core_count" placeholder="所在系统分配CPU核心数" />
                </label>
              </section>
              <section class="col col-6">
                <label class="label">所在系统分配内存大小（GB）</label>
                <label class="input">
                  <input type="text" name="memory_size" placeholder="所在系统分配内存大小（GB）" />
                </label>
              </section>
            </div>
            <div class="row">
              <section class="col col-6">
                <label class="label">所在系统分配硬盘大小（GB）</label>
                <label class="input">
                  <input type="text" name="disc_space" placeholder="所在系统分配硬盘大小（GB）" />
                </label>
              </section>
              <section class="col col-6">
                <label class="label">是否在虚拟机上</label>
                <label class="input">
                  <input type="hidden" name="virtual" data-type="select2" placeholder="是否在虚拟机上" />
                </label>
              </section>
            </div>
            <div class="row">
              <section class="col col-6">
                <label class="label">操作系统</label>
                <label class="input">
                  <input type="text" name="os" placeholder="操作系统" />
                </label>
              </section>
              <section class="col col-6">
                <label class="label">负责人PID</label>
                <label class="input">
                  <input type="text" name="pic_pid" placeholder="负责人PID" />
                </label>
              </section>
            </div>
            <div class="row">
              <section class="col col-6">
                <label class="label">负责人姓名</label>
                <label class="input">
                  <input type="text" name="pic_name" placeholder="负责人姓名" />
                </label>
              </section>
              <section class="col col-6">
                <label class="label">负责人手机号码</label>
                <label class="input">
                  <input type="text" name="pic_tel" placeholder="负责人手机号码" />
                </label>
              </section>
            </div>
            <div class="row">
              <section class="col col-6">
                <label class="label">是否在使用中</label>
                <label class="input">
                  <input type="hidden" name="in_use" data-type="select2" placeholder="是否在使用中" />
                </label>
              </section>
               <section class="col col-6">
                <label class="label">废弃时间</label>
                <label class="input">
                  <input type="text" name="abolish_time" placeholder="废弃时间" />
                   <b id="mgt_add_upd_abolish_time_b" class="tooltip tooltip-bottom-right"></b>
                </label>
              </section>
            </div>
            <div >
              <section >
                <label class="label">状态</label>
                <label class="input">
                  <input type="hidden" name="status" data-type="select2" placeholder="状态" />
                </label>
              </section>
            </div>
          </fieldset>
          <footer>
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="submit" class="btn btn-primary">确定</button>
          </footer>
        </form>
        <!-- FORM End -->
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!-- /.modal -->
<script type="text/javascript" src="lib/js/plugin/jquery-form/jquery.form.min.js"></script>
<!-- SCRIPTS ON PAGE EVENT -->
<script type="text/javascript">
  // DO NOT REMOVE : GLOBAL FUNCTIONS!
  pageSetUp();
  (function () {
    // 数据字典处理
    var cb = function () {
      // 字典数据绑定
      $('#mgt_add_upd_server_form input[name=status]').zySelect('ZR.0001', false, {
        width: '100%'
      });
      $('#mgt_add_upd_server_form input[name=server_type]').zySelect('ZR.0018', false, {
        width: '100%'
      });
      $('#mgt_add_upd_server_form input[name=virtual]').zySelect('ZR.0019', false, {
        width: '100%'
      });
      $('#mgt_add_upd_server_form input[name=in_use]').zySelect('ZR.0020', false, {
        width: '100%'
      });
      if (mgt_server._g.param.flg == 'i') {
        //添加
        $('#mgt_add_upd_server_title').text('添加');
        $('#mgt_add_upd_server_form input[name=abolish_time]').attr('readonly', true);
        $('#mgt_add_upd_abolish_time_b').remove();
        $('#mgt_add_upd_server_form input[name=status]').select2("val", '1');
      } else if (mgt_server._g.param.flg == 'u') {
        //修改
        $('#mgt_add_upd_server_form').formDisable(true);
        var callback = function (msg) {
          $('#mgt_add_upd_server_form').formDisable(false);
          if (msg) {
            Console.log("获取服务器信息数据 = " + JSON.stringify(msg));
            $('#mgt_add_upd_server_form').json2form(msg.result[0]);
          }
        };
        var server = {
          serverid: mgt_server._g.param.serverid
        };
        zy.g.am.app = 'zyapp_sysmgt';
        zy.g.am.mod = 'server_mgt';
        zy.net.get("api/getserverlistupt", callback, server);
        $('#mgt_add_upd_server_title').text('修改');
        $('#mgt_add_upd_server_form input[name=serverid]').attr('readonly', true);
        $('#mgt_add_upd_server_form input[name=abolish_time]').attr('readonly', true);
        $('#mgt_add_upd_serverid_b').remove();
        $('#mgt_add_upd_abolish_time_b').remove();
      }
    };
    // 预处理该画面所需的字典类型，以 , 号分割
    zy.cache.initDicts('ZR.0001,ZR.0018,ZR.0019,ZR.0020', cb);

  })();
  $('#mgt_add_upd_server').modal('show');
  // Registration validation script
  $("#mgt_add_upd_server_form").validate({
    // Rules for form validation
    rules: {
     /* serverid: {
        required: true,
        maxlength: 32
      },*/
      servernm: {
        required: true,
        maxlength: 50
      },
      server_v: {
        required: true,
        maxlength: 20
      },
      server_type: {
        required: true,
        maxlength: 100
      },
      server_type_detail: {
        maxlength: 100
      },
      inner_ip: {
        required: true,
        maxlength: 15
      },
      inner_port: {
        required: true,
        maxlength: 5
      },
      outer_ip: {
        maxlength: 15
      },
      outer_port: {
        maxlength: 5
      },
      mac: {
        maxlength: 17
      },
      cpu_core_count: {
        digits: true
      },
      memory_size: {
        digits: true
      },
      disc_space: {
        digits: true
      },
      os: {
        maxlength: 50
      },
      pic_name: {
        maxlength: 50
      },
      pic_tel: {
        isMobile: true,
        maxlength: 20
      },
      server_desc: {
        maxlength: 200
      }
    },
    // 验证成功后保存
    submitHandler: function (form) {
      var callback = function (msg) {
        $('#mgt_add_upd_server_form').formDisable(false);
        if (msg) {
          if (mgt_server._g.param.flg == 'u') {
            mgt_server.SetRow($('#mgt_add_upd_server_form').form2json());
          }
          $('#mgt_add_upd_server').modal('hide');
          zy.ui.msg("提示信息：", "保存成功！", "s");
        }
      };
      zy.g.am.app = 'zyapp_sysmgt';
      zy.g.am.mod = 'server_mgt';
      if (mgt_server._g.param.flg == 'i') {
        zy.net.post("api/addserverinfo", callback, $('#mgt_add_upd_server_form').serialize());
      } else if (mgt_server._g.param.flg == 'u') {
        zy.net.post("api/setserverinfo", callback, $('#mgt_add_upd_server_form').serialize());
      }
      $('#mgt_add_upd_server_form').formDisable(true);
    },
    // Do not change code below
    errorPlacement: function (error, element) {
      error.insertAfter(element.parent());
    }
  });
</script>
