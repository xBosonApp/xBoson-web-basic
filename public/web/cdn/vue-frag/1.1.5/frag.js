!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Frag=t()}(this,(function(){"use strict";var e=Symbol(),t=Symbol(),r=Symbol(),i=Symbol();function n(t,r){t[e]||(t[e]=r,Object.defineProperty(t,"parentNode",{get:function(){return this[e]||this.parentElement}}))}var a=function(t,r){var i=t.splice(0);r.append.apply(r,i),i.forEach((function(t){t[e]=void 0}))};function f(e,t){var i,a=this,f=e.frag||[e];if(this.frag){var o,s=this.frag.indexOf(t);if(s>-1)(o=this.frag).splice.apply(o,[s,0].concat(f))}if(this[r]){var h=this[r].get(t);h&&(t=h[0])}t?(i=t).before.apply(i,f):this.append.apply(this,f);f.forEach((function(e){return n(e,a)}))}function o(t){if(this.frag){var n=this.frag.indexOf(t);if(n>-1){var f,o=[n,1];if(1===this.frag.length){var s=this[i];this.frag[0].before(s),o.push(s)}(f=this.frag).splice.apply(f,o)}}var h=this[r];if(h){var c=h.get(t);if(c)return a(c,t),h.delete(t),void(t[e]=void 0)}t.remove()}var s={insertBefore:f,removeChild:o};var h={insertBefore:f,before:function(e){this.frag[0].before(e)},remove:function(){var e=this[i],t=this.frag,r=t.splice(0,t.length,e);r[0].before(this[i]),r.forEach((function(e){return e.remove()}))},removeChild:o,appendChild:function(e){var t=this.frag.length;this.frag[t-1].after(e);var r=this[i];this.frag[0]===r&&(this.frag.splice(0,1),r.remove()),n(e,this),this.frag.push(e)}};return{inserted:function(e){var a=e.parentNode,f=e.nextSibling,o=Array.from(e.childNodes);e.frag=o;var c=document.createComment("");e[i]=c,0===o.length&&o.push(c);var p,d,u,l,g,v=document.createDocumentFragment();v.append.apply(v,o),e.replaceWith(v),d=e,u=o,(p=a)[r]||(p[r]=new Map,Object.assign(p,s)),p[r].set(d,u),n(e,a),g=f,(l=e).hasOwnProperty(t)||(l[t]=g,Object.defineProperty(l,"nextSibling",{get:function(){if(!this.hasOwnProperty(t)){var e=Array.from(this.parentNode.childNodes).indexOf(this);return this.parentNode.childNodes.item(e+1)}return this[t]}})),o.forEach((function(t){return n(t,e)})),Object.defineProperty(e,"innerHTML",{set:function(t){var r=document.createElement("div");r.innerHTML=t;var i=e.frag.length;Array.from(r.childNodes).forEach((function(t){return e.appendChild(t)})),r.append.apply(r,e.frag.splice(0,i))},get:function(){return""}}),Object.assign(e,h)},unbind:function(e){a(e.frag,e),e[i].remove()}}}));
